<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<title>Generated by AscUrPic</title>
	</head>
<body style="background-color:#ffffff"><pre style="font-size:8px">
<span style="color:#fefefc;">#includestdio.h#includestdlib.h#includesys/types.h#includesys/stat.h#includestring.h#includeunistd.h#includetime.h#includefcntl.h#includeerrno.h#includectype.h#includelimits.h/**OriginalworkbyJeffGarz
ik**Externalfilelists,symlink,pipeandfifosupportbyThayneHarbaugh*HardlinksupportbyLucianoRocha*/#definexstr(s)#s#definestr(s)xstr(s)staticunsignedintoffset;staticunsignedintino=721;structfile_handler{
constchar*type;int(*handler)(constchar*line);};staticvoidpush_string(constchar*name){u</span><span style="color:#fcfcfb;">ns</span><span style="color:#dadad9;">ig</span><span style="color:#ababaa;">ne</span><span style="color:#868686;">di</span><span style="color:#747473;">nt</span><span style="color:#6c6c6b;">na</span><span style="color:#6a6a6a;">me</span><span style="color:#7d7d7d;">_l</span><span style="color:#9c9c9c;">en</span><span style="color:#c3c3c2;">=s</span><span style="color:#eaeae9;">tr</span><span style="color:#fdfdfb;">le</span><span style="color:#fefefc;">n(name)+1;fputs(name,stdout);putchar(0);offset+=name_len;}staticvoidpush_pad(void){while(o
ffset3){putchar(0);offset++;}}staticvoidpush_rest(constchar*name){unsignedintname_</span><span style="color:#f1f1ef;">le</span><span style="color:#989897;">n=</span><span style="color:#383839;">st</span><span style="color:#080808;">rl</span><span style="color:#040405;">en</span><span style="color:#020204;">(name)+1;uns</span><span style="color:#030304;">ig</span><span style="color:#0a0a0b;">ne</span><span style="color:#3a3a3a;">di</span><span style="color:#989898;">nt</span><span style="color:#eaeae8;">tm</span><span style="color:#fefefc;">p_ofs;fputs(name,stdout);putchar(0);offset+=name_len;tmp_ofs=name_len+110;while(tmp_of
s3){putchar(0);offset++;tmp_ofs++;}}staticvoidpush_hdr(constchar*s){fputs(s,st</span><span style="color:#fbfbf9;">do</span><span style="color:#9f9f9f;">ut</span><span style="color:#212122;">);</span><span style="color:#020204;">offset+=110;}staticvoidcpi</span><span style="color:#040304;">o_</span><span style="color:#111113;">tr</span><span style="color:#686868;">ai</span><span style="color:#d9d9d7;">le</span><span style="color:#fefefc;">r(void){chars[256];constcharname[]="TRAILER!!!";sprintf(s,"%s%08X%08X%08lX%08lX%08
X%08lX""%08X%08X%08X%08X%08X%08X%08X","070701",/*magic*/0,/*ino*/0,/*mode*/(</span><span style="color:#e8e8e6;">lo</span><span style="color:#4c4c4b;">ng</span><span style="color:#050507;">)0</span><span style="color:#020204;">,/*uid*/(long)0,/*gid*/1,/*nlink</span><span style="color:#050204;">*/</span><span style="color:#111011;">(l</span><span style="color:#7d7d7d;">on</span><span style="color:#f4f4f3;">g)</span><span style="color:#fefefc;">0,/*mtime*/0,/*filesize*/0,/*major*/0,/*minor*/0,/*rmajor*/0,/*rminor*/(unsign
ed)strlen(name)+1,/*namesize*/0);/*chksum*/push_hdr(s);push_rest(name);whi</span><span style="color:#dededc;">le</span><span style="color:#282829;">(o</span><span style="color:#020204;">ffset%512){putchar(0);offset++</span><span style="color:#030304;">;}</span><span style="color:#080809;">}s</span><span style="color:#050507;">ta</span><span style="color:#020204;">tici</span><span style="color:#050506;">nt</span><span style="color:#353535;">cp</span><span style="color:#d8d8d6;">io</span><span style="color:#fefefc;">_mkslink(constchar*name,constchar*target,unsignedintmode,uid_tuid,gid_tgid){
chars[256];time_tmtime=time(NULL);sprintf(s,"%s%08X%08X%08lX%08lX%08X%08</span><span style="color:#ebebea;">lX</span><span style="color:#2c2c2d;">""</span><span style="color:#020204;">%08X%08X%08X%08X%08X%08X%08X",</span><span style="color:#030304;">"0</span><span style="color:#101010;">70</span><span style="color:#282828;">70</span><span style="color:#2c2c2c;">1"</span><span style="color:#1d1d1d;">,/</span><span style="color:#09090a;">*m</span><span style="color:#020204;">agic</span><span style="color:#171718;">*/</span><span style="color:#c9c9c8;">in</span><span style="color:#fefefc;">o++,/*ino*/S_IFLNK|mode,/*mode*/(long)uid,/*uid*/(long)gid,/*gid*/1,/*nlin
k*/(long)mtime,/*mtime*/(unsigned)strlen(target)+1,/*filesize*/3,/*major</span><span style="color:#626162;">*/</span><span style="color:#020204;">1,/*minor*/0,/*rmajor*/0,/*rmino</span><span style="color:#060606;">r*</span><span style="color:#1b1b1b;">/(</span><span style="color:#3f3f3f;">un</span><span style="color:#5b5b5b;">si</span><span style="color:#504f50;">gn</span><span style="color:#2c2c2d;">ed</span><span style="color:#0f0f0f;">)s</span><span style="color:#030304;">tr</span><span style="color:#020204;">le</span><span style="color:#18181a;">n(</span><span style="color:#dddddc;">na</span><span style="color:#fefefc;">me)+1,/*namesize*/0);/*chksum*/push_hdr(s);push_string(name);push_pad();
push_string(target);push_pad();return0;}staticintcpio_mkslink_line(con</span><span style="color:#c2c2c1;">st</span><span style="color:#060607;">ch</span><span style="color:#020204;">ar*line){charname[PATH_MAX+1];ch</span><span style="color:#050506;">ar</span><span style="color:#1d1d1d;">ta</span><span style="color:#4c4c4c;">rg</span><span style="color:#757575;">et</span><span style="color:#6e6e6e;">[P</span><span style="color:#464646;">AT</span><span style="color:#242424;">H_</span><span style="color:#0c0c0c;">MA</span><span style="color:#020204;">X+1]</span><span style="color:#353536;">;u</span><span style="color:#f2f2f0;">ns</span><span style="color:#fefefc;">ignedintmode;intuid;intgid;intrc=-1;if(5!=sscanf(line,"%"str(PATH_MAX)
"s%"str(PATH_MAX)"s%o%d%d",name,target,mode,uid,gid)){fprintf(stderr</span><span style="color:#fdfdfb;">,"</span><span style="color:#3e3e3f;">Un</span><span style="color:#020204;">recognizeddirformat'%s'",line);got</span><span style="color:#050505;">of</span><span style="color:#212121;">ai</span><span style="color:#525252;">l;</span><span style="color:#737373;">}r</span><span style="color:#656565;">c=</span><span style="color:#454545;">cp</span><span style="color:#303030;">io</span><span style="color:#1c1c1c;">_m</span><span style="color:#060607;">ks</span><span style="color:#020204;">link</span><span style="color:#7b7b7b;">(n</span><span style="color:#fefefc;">ame,target,mode,uid,gid);fail:returnrc;}staticintcpio_mkgeneric(constc
har*name,unsignedintmode,uid_tuid,gid_tgid){chars[256];time_tmtime=t</span><span style="color:#cececd;">im</span><span style="color:#040405;">e(</span><span style="color:#020204;">NULL);sprintf(s,"%s%08X%08X%08lX%0</span><span style="color:#070707;">8l</span><span style="color:#232322;">X%</span><span style="color:#484848;">08</span><span style="color:#515151;">X%</span><span style="color:#404040;">08</span><span style="color:#2b2b2c;">lX</span><span style="color:#212121;">""</span><span style="color:#171717;">%0</span><span style="color:#060607;">8X</span><span style="color:#020204;">%08X</span><span style="color:#101011;">%0</span><span style="color:#dadad9;">8X</span><span style="color:#fefefc;">%08X%08X%08X%08X","070701",/*magic*/ino++,/*ino*/mode,/*mode*/(long)
uid,/*uid*/(long)gid,/*gid*/2,/*nlink*/(long)mtime,/*mtime*/0,/*file</span><span style="color:#727272;">si</span><span style="color:#020204;">ze*/3,/*major*/1,/*minor*/0,/*rmajor</span><span style="color:#080808;">*/</span><span style="color:#1b1b1b;">0,</span><span style="color:#2c2c2b;">/*</span><span style="color:#242423;">rm</span><span style="color:#151515;">in</span><span style="color:#0a0a0b;">or</span><span style="color:#060607;">*/</span><span style="color:#050506;">(u</span><span style="color:#020204;">nsigne</span><span style="color:#030204;">d)</span><span style="color:#606060;">st</span><span style="color:#fefefc;">rlen(name)+1,/*namesize*/0);/*chksum*/push_hdr(s);push_rest(name);re
turn0;}enumgeneric_types{GT_DIR,GT_PIPE,GT_SOCK};structgeneric_type{</span><span style="color:#2f2f30;">co</span><span style="color:#020204;">nstchar*type;mode_tmode;};staticstru</span><span style="color:#050505;">ct</span><span style="color:#0e0e0e;">ge</span><span style="color:#0f0f0f;">ne</span><span style="color:#050506;">ri</span><span style="color:#020204;">c_typegeneric_ty</span><span style="color:#0c0c0e;">pe</span><span style="color:#d8d8d6;">_t</span><span style="color:#fefefc;">able[]={[GT_DIR]={.type="dir",.mode=S_IFDIR},[GT_PIPE]={.type="pip
e",.mode=S_IFIFO},[GT_SOCK]={.type="sock",.mode=S_IFSOCK}};statici</span><span style="color:#ececea;">nt</span><span style="color:#070709;">cp</span><span style="color:#020204;">io_mkgeneric_line(constchar*line,enumg</span><span style="color:#030304;">ener</span><span style="color:#020204;">ic_typesgt){charname</span><span style="color:#7c7c7c;">[P</span><span style="color:#fefefc;">ATH_MAX+1];unsignedintmode;intuid;intgid;intrc=-1;if(4!=sscanf(lin
e,"%"str(PATH_MAX)"s%o%d%d",name,mode,uid,gid)){fprintf(stderr,"Un</span><span style="color:#c8c8c7;">re</span><span style="color:#020204;">cognized%sformat'%s'",line,generic_type_table[gt].type);gotofail</span><span style="color:#2e2d2f;">;}</span><span style="color:#fefefc;">mode|=generic_type_table[gt].mode;rc=cpio_mkgeneric(name,mode,uid,
gid);fail:returnrc;}staticintcpio_mkdir_line(constchar*line){retur</span><span style="color:#a2a2a1;">nc</span><span style="color:#020204;">pio_mkgene</span><span style="color:#030304;">ri</span><span style="color:#040406;">c_</span><span style="color:#030305;">li</span><span style="color:#020204;">ne(line,GT_DIR);}stati</span><span style="color:#040405;">ci</span><span style="color:#060607;">nt</span><span style="color:#070708;">cp</span><span style="color:#050506;">io</span><span style="color:#020204;">_mkpipe_line(const</span><span style="color:#040405;">ch</span><span style="color:#e8e8e7;">ar</span><span style="color:#fefefc;">*line){returncpio_mkgeneric_line(line,GT_PIPE);}staticintcpio_mk
sock_line(constchar*line){returncpio_mkgeneric_line(line,GT_SOCK);</span><span style="color:#848483;">}s</span><span style="color:#020204;">tatici</span><span style="color:#060607;">nt</span><span style="color:#0a0a0a;">cpio</span><span style="color:#191919;">_m</span><span style="color:#1b1b1b;">kn</span><span style="color:#070708;">od</span><span style="color:#020204;">(constchar*n</span><span style="color:#030304;">am</span><span style="color:#020204;">e,unsign</span><span style="color:#040406;">ed</span><span style="color:#0d0d0e;">in</span><span style="color:#2b2b2b;">tm</span><span style="color:#323233;">od</span><span style="color:#08080a;">e,</span><span style="color:#020204;">uid_tuid,gid_tgi</span><span style="color:#c2c2c0;">d,</span><span style="color:#fefefc;">chardev_type,unsignedintmaj,unsignedintmin){chars[256];time_tmti
me=time(NULL);if(dev_type=='b')mode|=S_IFBLK;elsemode|=S_IFCHR;spr</span><span style="color:#727171;">in</span><span style="color:#020204;">tf(s</span><span style="color:#050506;">,"</span><span style="color:#070708;">%s</span><span style="color:#030304;">%0</span><span style="color:#020204;">8X</span><span style="color:#0b0b0b;">%0</span><span style="color:#232324;">8X</span><span style="color:#2d2c2d;">%0</span><span style="color:#09090a;">8l</span><span style="color:#020204;">X%08lX%0</span><span style="color:#030304;">8X</span><span style="color:#040404;">%0</span><span style="color:#020204;">8l</span><span style="color:#030305;">X"</span><span style="color:#111112;">"%</span><span style="color:#2a2a2b;">08</span><span style="color:#2f2f2f;">X%</span><span style="color:#101011;">08</span><span style="color:#050507;">X%</span><span style="color:#2e2e2e;">08</span><span style="color:#353535;">X%</span><span style="color:#030305;">08</span><span style="color:#020204;">X%08X%08X%08X"</span><span style="color:#999999;">,"</span><span style="color:#fefefc;">070701",/*magic*/ino++,/*ino*/mode,/*mode*/(long)uid,/*uid*/(lon
g)gid,/*gid*/1,/*nlink*/(long)mtime,/*mtime*/0,/*filesize*/3,/*maj</span><span style="color:#6d6d6d;">or</span><span style="color:#020204;">*/1,/*</span><span style="color:#080809;">mi</span><span style="color:#353535;">no</span><span style="color:#5e5e5e;">r*</span><span style="color:#3e3e3f;">/m</span><span style="color:#09090b;">aj</span><span style="color:#1f1f1f;">,/</span><span style="color:#272728;">*r</span><span style="color:#030305;">ma</span><span style="color:#020204;">jor*</span><span style="color:#030304;">/m</span><span style="color:#040404;">in</span><span style="color:#020204;">,/</span><span style="color:#101012;">*r</span><span style="color:#4d4d4d;">mi</span><span style="color:#777778;">no</span><span style="color:#8e8e8e;">r*</span><span style="color:#9c9c9b;">/(</span><span style="color:#999999;">un</span><span style="color:#505050;">si</span><span style="color:#050507;">gn</span><span style="color:#262526;">ed</span><span style="color:#161616;">)s</span><span style="color:#020204;">trlen(name)+1,</span><span style="color:#6f6f70;">/*</span><span style="color:#fefefc;">namesize*/0);/*chksum*/push_hdr(s);push_rest(name);return0;}stat
icintcpio_mknod_line(constchar*line){charname[PATH_MAX+1];unsigned</span><span style="color:#6b6b6b;">in</span><span style="color:#020204;">tmod</span><span style="color:#050507;">e;</span><span style="color:#575758;">in</span><span style="color:#9a9a9a;">tu</span><span style="color:#bdbdbd;">id</span><span style="color:#b5b5b5;">;i</span><span style="color:#6b6b6b;">nt</span><span style="color:#121213;">gi</span><span style="color:#0e0e0e;">d;</span><span style="color:#050506;">ch</span><span style="color:#020204;">arde</span><span style="color:#040405;">v_</span><span style="color:#030304;">ty</span><span style="color:#161617;">pe</span><span style="color:#646464;">;u</span><span style="color:#8c8c8d;">ns</span><span style="color:#9f9f9f;">ig</span><span style="color:#adadad;">ne</span><span style="color:#b8b7b7;">di</span><span style="color:#c7c7c7;">nt</span><span style="color:#bcbcbc;">ma</span><span style="color:#4f4f4f;">j;</span><span style="color:#060608;">un</span><span style="color:#0d0d0d;">si</span><span style="color:#060607;">gn</span><span style="color:#020204;">edintmin;int</span><span style="color:#5f5f5f;">rc</span><span style="color:#fefefc;">=-1;if(7!=sscanf(line,"%"str(PATH_MAX)"s%o%d%d%c%u%u",name,mode,
uid,gid,dev_type,maj,min)){fprintf(stderr,"Unrecognizednodformat'%</span><span style="color:#707071;">s'</span><span style="color:#020204;">",li</span><span style="color:#252526;">ne</span><span style="color:#8b8b8c;">);</span><span style="color:#b5b5b4;">go</span><span style="color:#cfcfcf;">to</span><span style="color:#c8c8c8;">fa</span><span style="color:#aaaaaa;">il</span><span style="color:#696869;">;}</span><span style="color:#070708;">rc</span><span style="color:#030304;">=c</span><span style="color:#020204;">pio_mk</span><span style="color:#040405;">no</span><span style="color:#575757;">d(</span><span style="color:#9f9f9f;">na</span><span style="color:#cccccc;">me</span><span style="color:#dddddd;">,m</span><span style="color:#e2e2e2;">od</span><span style="color:#e4e4e4;">e,</span><span style="color:#e3e3e3;">ui</span><span style="color:#c4c4c4;">d,</span><span style="color:#8b8b8b;">gi</span><span style="color:#222222;">d,</span><span style="color:#030305;">dev_</span><span style="color:#020204;">type,maj,min</span><span style="color:#444445;">);</span><span style="color:#fefefc;">fail:returnrc;}staticintcpio_mkfile(constchar*name,constchar*loc
ation,unsignedintmode,uid_tuid,gid_tgid,unsignedintnlinks){chars[2</span><span style="color:#777777;">56</span><span style="color:#020204;">];ch</span><span style="color:#575757;">ar</span><span style="color:#c5c5c4;">*f</span><span style="color:#ededee;">il</span><span style="color:#fafafa;">eb</span><span style="color:#fbfbfb;">uf</span><span style="color:#fbfbfa;">=N</span><span style="color:#e7e7e6;">UL</span><span style="color:#262627;">L;</span><span style="color:#020204;">structst</span><span style="color:#181819;">at</span><span style="color:#b2b1b1;">bu</span><span style="color:#f2f2f1;">f;</span><span style="color:#fdfdfc;">lo</span><span style="color:#fbfbfa;">ng</span><span style="color:#ccccca;">si</span><span style="color:#c5c5c5;">ze</span><span style="color:#fafaf9;">;i</span><span style="color:#fafafa;">nt</span><span style="color:#d2d2d3;">fi</span><span style="color:#646465;">le</span><span style="color:#020204;">=-1;intretval;in</span><span style="color:#272728;">tr</span><span style="color:#fefefc;">c=-1;intnamesize;inti;mode|=S_IFREG;retval=stat(location,buf);if
(retval){fprintf(stderr,"File%scouldnotbelocated\n",location);goto</span><span style="color:#8d8d8c;">er</span><span style="color:#020204;">ro</span><span style="color:#030305;">r;</span><span style="color:#969696;">}f</span><span style="color:#fafaf9;">il</span><span style="color:#858585;">e=</span><span style="color:#3b3b3b;">op</span><span style="color:#7e7e7e;">en</span><span style="color:#f5f5f5;">(l</span><span style="color:#fefefc;">oc</span><span style="color:#767676;">at</span><span style="color:#030305;">io</span><span style="color:#020204;">n,</span><span style="color:#060607;">O_</span><span style="color:#020204;">RD</span><span style="color:#373738;">ON</span><span style="color:#d7d7d7;">LY</span><span style="color:#fdfdfc;">);</span><span style="color:#f9f9f8;">if</span><span style="color:#666666;">(f</span><span style="color:#0b0b0c;">il</span><span style="color:#373738;">e0</span><span style="color:#5b5b5b;">){</span><span style="color:#ebebea;">fp</span><span style="color:#fefefc;">ri</span><span style="color:#cdcdcd;">nt</span><span style="color:#0f0f10;">f(</span><span style="color:#020204;">stderr,"File%s</span><span style="color:#212123;">co</span><span style="color:#fefefc;">uldnotbeopenedforreading\n",location);gotoerror;}filebuf=malloc(
buf.st_size);if(!filebuf){fprintf(stderr,"outofmemory\n");gotoerro</span><span style="color:#a4a4a4;">r;</span><span style="color:#020204;">}r</span><span style="color:#070708;">et</span><span style="color:#c7c7c7;">va</span><span style="color:#c8c7c8;">l=</span><span style="color:#040406;">re</span><span style="color:#403f40;">ad</span><span style="color:#5d5d5d;">(f</span><span style="color:#7f7f7f;">il</span><span style="color:#fdfdfc;">e,</span><span style="color:#adadad;">fi</span><span style="color:#0a0a0b;">le</span><span style="color:#090909;">bu</span><span style="color:#141415;">f,</span><span style="color:#030304;">bu</span><span style="color:#424242;">f.</span><span style="color:#dddddc;">st</span><span style="color:#fefefc;">_s</span><span style="color:#a2a2a2;">iz</span><span style="color:#030305;">e)</span><span style="color:#060608;">;i</span><span style="color:#555556;">f(</span><span style="color:#747475;">re</span><span style="color:#636362;">tv</span><span style="color:#fdfdfb;">al</span><span style="color:#f9f9f8;">0)</span><span style="color:#2c2c2d;">{f</span><span style="color:#020204;">printf(stderr,</span><span style="color:#1e1e1f;">"C</span><span style="color:#fefefc;">annotread%sfile\n",location);gotoerror;}size=0;for(i=1;i=nlinks;
i++){/*datagoesonlastlink*/if(i==nlinks)size=buf.st_size;namesize=</span><span style="color:#afafaf;">st</span><span style="color:#020204;">rl</span><span style="color:#080809;">en</span><span style="color:#d0d0d0;">(n</span><span style="color:#7e7e7f;">am</span><span style="color:#020204;">e)</span><span style="color:#111112;">+1</span><span style="color:#6a6a6a;">;s</span><span style="color:#2c2c2c;">pr</span><span style="color:#f5f5f4;">in</span><span style="color:#babab9;">tf</span><span style="color:#101011;">(s</span><span style="color:#1b1b1b;">,"</span><span style="color:#3b3b3b;">%s</span><span style="color:#343434;">%0</span><span style="color:#464646;">8X</span><span style="color:#dddddd;">%0</span><span style="color:#fcfcfb;">8X</span><span style="color:#3f3f40;">%0</span><span style="color:#020204;">8l</span><span style="color:#040405;">X%</span><span style="color:#141415;">08</span><span style="color:#5a5a5a;">lX</span><span style="color:#262627;">%0</span><span style="color:#f4f4f3;">8X</span><span style="color:#fcfcfa;">%0</span><span style="color:#595958;">8l</span><span style="color:#020204;">X""%08lX%08X%0</span><span style="color:#18181a;">8X</span><span style="color:#fcfcfb;">%0</span><span style="color:#fefefc;">8X%08X%08X%08X","070701",/*magic*/ino,/*ino*/mode,/*mode*/(lon
g)uid,/*uid*/(long)gid,/*gid*/nlinks,/*nlink*/(long)buf.st_mtime,/</span><span style="color:#bcbcba;">*m</span><span style="color:#020204;">ti</span><span style="color:#070709;">me</span><span style="color:#cecece;">*/</span><span style="color:#777777;">si</span><span style="color:#050506;">ze</span><span style="color:#040405;">,/</span><span style="color:#3b3b3b;">*f</span><span style="color:#181818;">il</span><span style="color:#d8d8d7;">es</span><span style="color:#959595;">iz</span><span style="color:#060606;">e*</span><span style="color:#050405;">/3</span><span style="color:#040406;">,/</span><span style="color:#101011;">*m</span><span style="color:#151516;">aj</span><span style="color:#b2b2b2;">or</span><span style="color:#fafafa;">*/</span><span style="color:#232324;">1,</span><span style="color:#020204;">/*</span><span style="color:#040406;">mi</span><span style="color:#050507;">no</span><span style="color:#080809;">r*</span><span style="color:#0f0f10;">/0</span><span style="color:#e4e4e3;">,/</span><span style="color:#fbfbfa;">*r</span><span style="color:#646464;">ma</span><span style="color:#020204;">jor*/0,/*rmino</span><span style="color:#101012;">r*</span><span style="color:#f9f9f7;">/n</span><span style="color:#fefefc;">amesize,/*namesize*/0);/*chksum*/push_hdr(s);push_string(name)
;push_pad();if(size){fwrite(filebuf,size,1,stdout);offset+=size;pu</span><span style="color:#cececc;">sh</span><span style="color:#020204;">_p</span><span style="color:#040406;">ad</span><span style="color:#bbbbbb;">()</span><span style="color:#989898;">;}</span><span style="color:#030305;">na</span><span style="color:#020204;">me</span><span style="color:#0e0e0f;">+=</span><span style="color:#070709;">na</span><span style="color:#c2bfb9;">me</span><span style="color:#62522a;">si</span><span style="color:#775b07;">ze</span><span style="color:#896a08;">;}</span><span style="color:#846608;">in</span><span style="color:#7c600a;">o+</span><span style="color:#58440a;">+;</span><span style="color:#736d5f;">rc</span><span style="color:#f1f1f1;">=0</span><span style="color:#2f2f31;">;e</span><span style="color:#020204;">rror:if(</span><span style="color:#0a0a0b;">fi</span><span style="color:#f2f2f2;">le</span><span style="color:#f9f9f8;">bu</span><span style="color:#5e5e5e;">f)</span><span style="color:#020204;">free(filebuf);</span><span style="color:#0b0b0d;">if</span><span style="color:#f3f3f2;">(f</span><span style="color:#fefefc;">ile=0)close(file);returnrc;}staticintcpio_mkfile_line(constcha
r*line){charname[PATH_MAX+1];char*dname=NULL;/*malloc'edbufferforh</span><span style="color:#dddddc;">ar</span><span style="color:#050507;">dl</span><span style="color:#020204;">in</span><span style="color:#949494;">ks</span><span style="color:#e1e1e1;">*/</span><span style="color:#19191a;">ch</span><span style="color:#020204;">ar</span><span style="color:#030304;">lo</span><span style="color:#322305;">ca</span><span style="color:#ab8018;">ti</span><span style="color:#d5a00a;">on</span><span style="color:#edb90b;">[P</span><span style="color:#e6b60a;">AT</span><span style="color:#e3b40a;">H_</span><span style="color:#d4a60a;">MA</span><span style="color:#c99d0a;">X+</span><span style="color:#d0a50b;">1]</span><span style="color:#cfb559;">;u</span><span style="color:#746d5b;">ns</span><span style="color:#020204;">ignedint</span><span style="color:#5e5e5f;">mo</span><span style="color:#fdfdfb;">de</span><span style="color:#f2f2f1;">;i</span><span style="color:#383839;">nt</span><span style="color:#020204;">uid;intgid;int</span><span style="color:#060608;">nl</span><span style="color:#ededec;">in</span><span style="color:#fefefc;">ks=1;intend=0,dname_len=0;intrc=-1;if(5sscanf(line,"%"str(PATH
_MAX)"s%"str(PATH_MAX)"s%o%d%d%n",name,location,mode,uid,gid,end))</span><span style="color:#e8e8e6;">{f</span><span style="color:#070709;">pr</span><span style="color:#020204;">in</span><span style="color:#555455;">tf</span><span style="color:#f2f2f2;">(s</span><span style="color:#ababab;">td</span><span style="color:#100d0b;">er</span><span style="color:#674706;">r,</span><span style="color:#b88308;">"U</span><span style="color:#bb8909;">nr</span><span style="color:#e7af0b;">ec</span><span style="color:#edbb0b;">og</span><span style="color:#e8bc0b;">ni</span><span style="color:#e3ba0a;">ze</span><span style="color:#cfa70a;">df</span><span style="color:#ae8709;">il</span><span style="color:#d5ab0c;">ef</span><span style="color:#eec00c;">or</span><span style="color:#dfb00c;">ma</span><span style="color:#8d6d08;">t'</span><span style="color:#2e2305;">%s</span><span style="color:#0c0a07;">'"</span><span style="color:#4f4f4f;">,l</span><span style="color:#ececeb;">in</span><span style="color:#fdfdfb;">e)</span><span style="color:#c5c5c5;">;g</span><span style="color:#09090a;">ot</span><span style="color:#020204;">ofail;}if(endisg</span><span style="color:#dededc;">ra</span><span style="color:#fefefc;">ph(line[end])){intlen;intnend;dname=malloc(strlen(line));if(!d
name){fprintf(stderr,"outofmemory(%d)\n",dname_len);gotofail;}dnam</span><span style="color:#f8f8f7;">e_</span><span style="color:#0d0d0e;">le</span><span style="color:#020204;">n=</span><span style="color:#171718;">st</span><span style="color:#cdcdcd;">rl</span><span style="color:#f2f0eb;">en</span><span style="color:#ab8637;">(n</span><span style="color:#bb8507;">am</span><span style="color:#d8a108;">e)</span><span style="color:#ecb40b;">+1</span><span style="color:#edb80b;">;m</span><span style="color:#eabb0b;">em</span><span style="color:#e8be0b;">cp</span><span style="color:#e9c30b;">y(</span><span style="color:#ecc910;">dn</span><span style="color:#eccb24;">am</span><span style="color:#f1d12c;">e,</span><span style="color:#f3d228;">na</span><span style="color:#f1ce1d;">me</span><span style="color:#f0ca0e;">,d</span><span style="color:#e8b80b;">na</span><span style="color:#bf960e;">me</span><span style="color:#cab271;">_l</span><span style="color:#e0d8c4;">en</span><span style="color:#e2e0db;">);</span><span style="color:#585858;">do</span><span style="color:#020204;">{nend=0;if(sscanf(</span><span style="color:#c9c9c8;">li</span><span style="color:#fefefc;">ne+end,"%"str(PATH_MAX)"s%n",name,nend)1)break;len=strlen(name
)+1;memcpy(dname+dname_len,name,len);dname_len+=len;nlinks++;end+=</span><span style="color:#fcfcfb;">ne</span><span style="color:#111113;">nd</span><span style="color:#020204;">;}wh</span><span style="color:#6e6a63;">il</span><span style="color:#b58f3d;">e(</span><span style="color:#be8508;">is</span><span style="color:#d19807;">gr</span><span style="color:#e4ad09;">ap</span><span style="color:#ecb60b;">h(</span><span style="color:#ecb90b;">li</span><span style="color:#ebbc0b;">ne</span><span style="color:#e9c20b;">[e</span><span style="color:#ecca10;">nd</span><span style="color:#efd219;">])</span><span style="color:#f3d72d;">);</span><span style="color:#f5d833;">}e</span><span style="color:#f6d846;">ls</span><span style="color:#f5d827;">e{</span><span style="color:#f5d710;">dn</span><span style="color:#f3cf0d;">am</span><span style="color:#f2c70d;">e=</span><span style="color:#ecc10e;">na</span><span style="color:#e1b10e;">me</span><span style="color:#c29414;">;}</span><span style="color:#654c09;">rc</span><span style="color:#070504;">=c</span><span style="color:#020204;">pio_mkfile(dname</span><span style="color:#c1c0bf;">,l</span><span style="color:#fefefc;">ocation,mode,uid,gid,nlinks);fail:if(dname_len)free(dname);ret
urnrc;}voidusage(constchar*prog){fprintf(stderr,"Usage:\n""\t%scpio_</span><span style="color:#161618;">li</span><span style="color:#020204;">st</span><span style="color:#181104;">\n</span><span style="color:#8b6007;">""</span><span style="color:#b77e07;">\n</span><span style="color:#cb9007;">""</span><span style="color:#dda307;">cp</span><span style="color:#e8b10b;">io</span><span style="color:#ecb70b;">_l</span><span style="color:#ecba0b;">is</span><span style="color:#eac00b;">ti</span><span style="color:#eac70d;">sa</span><span style="color:#eccd12;">fi</span><span style="color:#f1d41c;">le</span><span style="color:#f4d93e;">co</span><span style="color:#f6d94d;">nt</span><span style="color:#f6d932;">ai</span><span style="color:#f5d819;">ni</span><span style="color:#f6d90e;">ng</span><span style="color:#f6d80d;">newl</span><span style="color:#f5d60d;">in</span><span style="color:#f5d60e;">es</span><span style="color:#f3cc2d;">ep</span><span style="color:#e3b017;">ar</span><span style="color:#4c3806;">at</span><span style="color:#020204;">edentriesthat\n"</span><span style="color:#a4a4a3;">"d</span><span style="color:#fefefc;">escribethefilestobeincludedintheinitramfsarchive:\n""\n""#acom
ment\n""filenamelocationmodeuidgid[hardlinks]\n""dirnamemodeuidgid\n</span><span style="color:#1c1c1e;">""</span><span style="color:#050404;">no</span><span style="color:#6f4d06;">dn</span><span style="color:#b37b0a;">am</span><span style="color:#c38608;">em</span><span style="color:#d59a08;">od</span><span style="color:#e4ab09;">eu</span><span style="color:#ebb40b;">id</span><span style="color:#edb80b;">gi</span><span style="color:#ecbd0b;">dd</span><span style="color:#eac40c;">ev</span><span style="color:#ebca10;">_t</span><span style="color:#edd01a;">yp</span><span style="color:#f2d62f;">em</span><span style="color:#f5da54;">aj</span><span style="color:#f6da38;">mi</span><span style="color:#f6da16;">n\</span><span style="color:#f6d90f;">n"</span><span style="color:#f6d80d;">"s</span><span style="color:#f6d70d;">li</span><span style="color:#f6d80d;">nk</span><span style="color:#f2d10c;">na</span><span style="color:#cba80f;">me</span><span style="color:#d9af14;">ta</span><span style="color:#eebc19;">rg</span><span style="color:#6c5009;">et</span><span style="color:#030304;">mo</span><span style="color:#020204;">deuidgid\n""pi</span><span style="color:#666666;">pe</span><span style="color:#fefefc;">namemodeuidgid\n""socknamemodeuidgid\n""\n""namenameofthefile/
dir/nod/etcinthearchive\n""locationlocationofthefileinthecurrentfile</span><span style="color:#313132;">sy</span><span style="color:#110c04;">st</span><span style="color:#a16e07;">em</span><span style="color:#b77d08;">\n</span><span style="color:#cb8e08;">""</span><span style="color:#dba108;">ta</span><span style="color:#e7af0a;">rg</span><span style="color:#edb60b;">et</span><span style="color:#edb90b;">li</span><span style="color:#ecc00b;">nk</span><span style="color:#eac60d;">ta</span><span style="color:#edcd11;">rg</span><span style="color:#f0d41f;">et</span><span style="color:#f3d748;">\n</span><span style="color:#f5d83a;">""</span><span style="color:#f6d813;">mo</span><span style="color:#f6d90d;">de</span><span style="color:#f6d80c;">mo</span><span style="color:#f5d70c;">de</span><span style="color:#f5d60c;">/p</span><span style="color:#e0bd0d;">er</span><span style="color:#b89111;">mi</span><span style="color:#b8880a;">ss</span><span style="color:#d49c08;">io</span><span style="color:#d9a10b;">ns</span><span style="color:#493708;">of</span><span style="color:#020204;">thefile\n""uidus</span><span style="color:#242425;">er</span><span style="color:#fdfdfb;">id</span><span style="color:#fefefc;">(0=root)\n""gidgroupid(0=root)\n""dev_typedevicetype(b=block
,c=character)\n""majmajornumberofnod\n""minminornumberofnod\n""hardl</span><span style="color:#383839;">in</span><span style="color:#150f05;">ks</span><span style="color:#9f7008;">sp</span><span style="color:#ba8308;">ac</span><span style="color:#d39808;">es</span><span style="color:#dfa508;">ep</span><span style="color:#ebb20b;">ar</span><span style="color:#efb80c;">at</span><span style="color:#eebb0b;">ed</span><span style="color:#ebc20b;">li</span><span style="color:#ecc90e;">st</span><span style="color:#eed018;">of</span><span style="color:#f1d538;">ot</span><span style="color:#f4d735;">he</span><span style="color:#f6d813;">rl</span><span style="color:#f5d60d;">in</span><span style="color:#f5d70c;">ks</span><span style="color:#f5d60c;">to</span><span style="color:#f1d10c;">fi</span><span style="color:#c49f0c;">le</span><span style="color:#b6850d;">\n</span><span style="color:#d09508;">""</span><span style="color:#d89d07;">\n</span><span style="color:#db9f0c;">""</span><span style="color:#d69b0d;">ex</span><span style="color:#443207;">am</span><span style="color:#020204;">ple:\n""#Asimple</span><span style="color:#030305;">in</span><span style="color:#c3c3c3;">it</span><span style="color:#fefefc;">ramfs\n""dir/dev075500\n""nod/dev/console060000c51\n""dir/ro
ot070000\n""dir/sbin075500\n""file/sbin/kinit/usr/src/klibc/kinit/ki</span><span style="color:#373738;">ni</span><span style="color:#040404;">t0</span><span style="color:#3e2c05;">75</span><span style="color:#845d07;">50</span><span style="color:#cb9908;">0\</span><span style="color:#e6ae0a;">n"</span><span style="color:#efb60c;">,p</span><span style="color:#f0b90c;">ro</span><span style="color:#eebe0b;">g)</span><span style="color:#ecc60c;">;}</span><span style="color:#eecd12;">st</span><span style="color:#f0d217;">ru</span><span style="color:#f3d621;">ct</span><span style="color:#f5d710;">fi</span><span style="color:#f6d80c;">le</span><span style="color:#f3d30d;">_h</span><span style="color:#efce0f;">an</span><span style="color:#d7b30c;">dl</span><span style="color:#ae8209;">er</span><span style="color:#c28809;">fi</span><span style="color:#d4970a;">le</span><span style="color:#d89c0b;">_h</span><span style="color:#d99f07;">an</span><span style="color:#d7990d;">dl</span><span style="color:#c1890b;">er</span><span style="color:#1b1506;">_t</span><span style="color:#020204;">able</span><span style="color:#0a0a0b;">[]</span><span style="color:#373738;">={</span><span style="color:#0e0e0f;">{.</span><span style="color:#020204;">type="fi</span><span style="color:#707070;">le</span><span style="color:#fefefc;">",.handler=cpio_mkfile_line,},{.type="nod",.handler=cpio_mkn
od_line,},{.type="dir",.handler=cpio_mkdir_line,},{.type="slink",.ha</span><span style="color:#4c4c4d;">nd</span><span style="color:#020204;">le</span><span style="color:#0c0904;">r=</span><span style="color:#634207;">cp</span><span style="color:#7e5605;">io</span><span style="color:#c29509;">_m</span><span style="color:#ecb80b;">ks</span><span style="color:#f0be0c;">li</span><span style="color:#efc40d;">nk</span><span style="color:#eece24;">_l</span><span style="color:#efd22d;">in</span><span style="color:#f1d41c;">e,</span><span style="color:#f3d50e;">},</span><span style="color:#f3d30c;">{.</span><span style="color:#ebc80c;">ty</span><span style="color:#cba80c;">pe</span><span style="color:#9e7708;">="</span><span style="color:#a37108;">pi</span><span style="color:#cb8f09;">pe</span><span style="color:#d6990c;">",</span><span style="color:#d99e0a;">.h</span><span style="color:#d99e09;">an</span><span style="color:#cf940a;">dl</span><span style="color:#be8615;">er</span><span style="color:#78602d;">=c</span><span style="color:#080809;">pi</span><span style="color:#020204;">o_mk</span><span style="color:#0b0b0c;">pi</span><span style="color:#6a6a6a;">pe</span><span style="color:#696969;">_l</span><span style="color:#2e2e2f;">in</span><span style="color:#0e0e0f;">e,</span><span style="color:#020204;">},{.</span><span style="color:#19191b;">ty</span><span style="color:#f1f1f0;">pe</span><span style="color:#fefefc;">="sock",.handler=cpio_mksock_line,},{.type=NULL,.handler=N
ULL,}};#defineLINE_SIZE(2*PATH_MAX+50)intmain(intargc,char*argv[]){F</span><span style="color:#49494a;">IL</span><span style="color:#020204;">E*</span><span style="color:#070707;">cp</span><span style="color:#504b40;">io</span><span style="color:#94773b;">_l</span><span style="color:#815805;">is</span><span style="color:#977007;">t;</span><span style="color:#bc9309;">ch</span><span style="color:#d0ad0e;">ar</span><span style="color:#d6b619;">li</span><span style="color:#d4b518;">ne</span><span style="color:#ccaa0f;">[L</span><span style="color:#be9a0c;">IN</span><span style="color:#a98008;">E_</span><span style="color:#a07207;">SI</span><span style="color:#a67306;">ZE</span><span style="color:#c08507;">];</span><span style="color:#cf9109;">ch</span><span style="color:#d29509;">ar</span><span style="color:#d39908;">*a</span><span style="color:#ce930b;">rg</span><span style="color:#c5901e;">s,</span><span style="color:#c0a56d;">*t</span><span style="color:#bcb6a8;">yp</span><span style="color:#b5b5b3;">e;</span><span style="color:#343434;">in</span><span style="color:#020204;">tec=</span><span style="color:#060607;">0;</span><span style="color:#3b3b3b;">in</span><span style="color:#808080;">tl</span><span style="color:#7f7f7f;">in</span><span style="color:#626262;">e_</span><span style="color:#070708;">nr</span><span style="color:#020204;">=0;i</span><span style="color:#969696;">f(</span><span style="color:#fefefc;">2!=argc){usage(argv[0]);exit(1);}if(!(cpio_list=fopen(argv
[1],"r"))){fprintf(stderr,"ERROR:unabletoopen'%s':%s\n\n",argv[1],st</span><span style="color:#444445;">re</span><span style="color:#020204;">rr</span><span style="color:#050506;">or</span><span style="color:#7f7f7e;">(e</span><span style="color:#bbb8b3;">rr</span><span style="color:#9a772f;">no</span><span style="color:#9e6b06;">))</span><span style="color:#a06e06;">;u</span><span style="color:#b2880b;">sa</span><span style="color:#ba930e;">ge</span><span style="color:#b78f0c;">(a</span><span style="color:#b98a0a;">rg</span><span style="color:#c18908;">v[</span><span style="color:#c78d08;">0]</span><span style="color:#ca8d08;">);</span><span style="color:#cd8f09;">ex</span><span style="color:#d09109;">it</span><span style="color:#ce9009;">(1</span><span style="color:#c68b09;">);</span><span style="color:#bb8512;">}w</span><span style="color:#bb9b5f;">hi</span><span style="color:#c2bcb2;">le</span><span style="color:#cacac8;">(f</span><span style="color:#c3c3c1;">ge</span><span style="color:#bebebc;">ts</span><span style="color:#787878;">(l</span><span style="color:#020204;">ine,LI</span><span style="color:#0f0f10;">NE</span><span style="color:#6e6e6e;">_S</span><span style="color:#818181;">IZ</span><span style="color:#7c7c7c;">E,</span><span style="color:#3f3f3f;">cp</span><span style="color:#030305;">io</span><span style="color:#020204;">_l</span><span style="color:#242425;">is</span><span style="color:#f2f2f0;">t)</span><span style="color:#fefefc;">){inttype_idx;size_tslen=strlen(line);line_nr++;if('#'==
*line){/*comment-skiptonextline*/continue;}if(!(type=strtok(line,"\t</span><span style="color:#29292a;">")</span><span style="color:#020204;">))</span><span style="color:#121212;">{f</span><span style="color:#8d8d8c;">pr</span><span style="color:#bdbdbc;">in</span><span style="color:#b7b2a9;">tf</span><span style="color:#9d7223;">(s</span><span style="color:#9a6706;">td</span><span style="color:#b38108;">er</span><span style="color:#d5a70a;">r,</span><span style="color:#daa809;">"E</span><span style="color:#d59d08;">RR</span><span style="color:#d4950b;">OR</span><span style="color:#d2930a;">:i</span><span style="color:#cf8f0a;">nc</span><span style="color:#c8890a;">or</span><span style="color:#c3850a;">re</span><span style="color:#be840c;">ct</span><span style="color:#b58a2b;">fo</span><span style="color:#baac8f;">rm</span><span style="color:#bdbcbc;">at</span><span style="color:#bfbebe;">,c</span><span style="color:#c8c8c8;">ou</span><span style="color:#cdcdcd;">ld</span><span style="color:#c1c1c0;">no</span><span style="color:#a2a1a0;">tl</span><span style="color:#0c0c0c;">oc</span><span style="color:#020204;">atef</span><span style="color:#040405;">il</span><span style="color:#383738;">et</span><span style="color:#7d7d7d;">yp</span><span style="color:#6f6e6f;">el</span><span style="color:#2b2b2b;">in</span><span style="color:#020204;">e%d:'%</span><span style="color:#787879;">s'</span><span style="color:#fefefc;">\n",line_nr,line);ec=-1;break;}if('\n'==*type){/*ablankl
ine*/continue;}if(slen==strlen(type)){/*mustbeanemptyline*/continu</span><span style="color:#d1d1d0;">e;</span><span style="color:#080809;">}i</span><span style="color:#020204;">f(</span><span style="color:#101011;">!(</span><span style="color:#888787;">ar</span><span style="color:#bebdbc;">gs</span><span style="color:#bdbcbc;">=s</span><span style="color:#bab2a7;">tr</span><span style="color:#9b762e;">to</span><span style="color:#986708;">k(</span><span style="color:#b17a08;">NU</span><span style="color:#c2860a;">LL</span><span style="color:#c5870a;">,"</span><span style="color:#c6880a;">\n</span><span style="color:#be8109;">")</span><span style="color:#b27808;">))</span><span style="color:#ad7407;">{f</span><span style="color:#b47c0d;">pr</span><span style="color:#b9954b;">in</span><span style="color:#bdb8af;">tf</span><span style="color:#bdbbba;">(s</span><span style="color:#bdbcbc;">td</span><span style="color:#c7c7c7;">er</span><span style="color:#dcdcdc;">r,</span><span style="color:#ececec;">"E</span><span style="color:#efefee;">RR</span><span style="color:#d3d3d2;">OR</span><span style="color:#464646;">:i</span><span style="color:#020204;">ncorre</span><span style="color:#0b0b0c;">ct</span><span style="color:#262627;">fo</span><span style="color:#2c2c2c;">rm</span><span style="color:#050507;">at</span><span style="color:#020204;">,newli</span><span style="color:#0c0c0e;">ne</span><span style="color:#e2e2e0;">re</span><span style="color:#fefefc;">quiredline%d:'%s'\n",line_nr,line);ec=-1;}for(type_idx
=0;file_handler_table[type_idx].type;type_idx++){intrc;if(!strcmp(</span><span style="color:#5e5e5f;">li</span><span style="color:#020204;">ne,f</span><span style="color:#0d0d0e;">il</span><span style="color:#878788;">e_</span><span style="color:#c8c7c7;">ha</span><span style="color:#c1c0bf;">nd</span><span style="color:#bdbbbb;">le</span><span style="color:#bbb7b2;">r_</span><span style="color:#a48d5f;">ta</span><span style="color:#926918;">bl</span><span style="color:#976509;">e[</span><span style="color:#986508;">ty</span><span style="color:#996508;">pe</span><span style="color:#9a6609;">_i</span><span style="color:#9c6a10;">dx</span><span style="color:#a98136;">].</span><span style="color:#bba77f;">ty</span><span style="color:#bebbb8;">pe</span><span style="color:#bdbbbb;">))</span><span style="color:#bfbebe;">{i</span><span style="color:#cecece;">f(</span><span style="color:#eaeaea;">(r</span><span style="color:#fbfbfa;">c=</span><span style="color:#fdfdfc;">file</span><span style="color:#f6f6f5;">_h</span><span style="color:#acabac;">an</span><span style="color:#080809;">dl</span><span style="color:#020204;">er_table[type_idx]</span><span style="color:#050507;">.h</span><span style="color:#626262;">an</span><span style="color:#fefefc;">dler(args))){ec=rc;fprintf(stderr,"line%d\n",line_nr);
}break;}}if(NULL==file_handler_table[type_idx].type){fprintf(std</span><span style="color:#c7c7c7;">er</span><span style="color:#09090b;">r,</span><span style="color:#020204;">"unk</span><span style="color:#171717;">no</span><span style="color:#c4c4c5;">wn</span><span style="color:#dfdfdf;">fi</span><span style="color:#cbcbcb;">le</span><span style="color:#bebebd;">ty</span><span style="color:#bdbdbc;">pe</span><span style="color:#bfbebe;">li</span><span style="color:#b9b6ae;">ne</span><span style="color:#ad9f86;">%d</span><span style="color:#a8936c;">:'</span><span style="color:#aa9369;">%s</span><span style="color:#b1a07f;">'\</span><span style="color:#b9b1a2;">n"</span><span style="color:#bebcbb;">,l</span><span style="color:#bdbbb9;">in</span><span style="color:#bebcbb;">e_</span><span style="color:#c2c1c0;">nr</span><span style="color:#d0d0d0;">,l</span><span style="color:#e9e9e9;">in</span><span style="color:#fbfbfb;">e)</span><span style="color:#fefefc;">;}}if(ec</span><span style="color:#f6f6f5;">==</span><span style="color:#4d4d4d;">0)</span><span style="color:#030305;">cp</span><span style="color:#020204;">io_trailer();exit(</span><span style="color:#0b0b0c;">ec</span><span style="color:#cdcdcc;">);</span><span style="color:#fefefc;">}#includestdio.h#includestdlib.h#includesys/types.h#
includesys/stat.h#includestring.h#includeunistd.h#includetime.</span><span style="color:#f4f4f2;">h#</span><span style="color:#303031;">in</span><span style="color:#030304;">cl</span><span style="color:#020204;">udef</span><span style="color:#828282;">cn</span><span style="color:#fcfcfb;">tl</span><span style="color:#eeeeee;">.h</span><span style="color:#d4d4d5;">#i</span><span style="color:#bfbebd;">nc</span><span style="color:#bebdbc;">lu</span><span style="color:#bebebd;">deerrno.h#</span><span style="color:#bebebe;">in</span><span style="color:#bebdbc;">cl</span><span style="color:#bebcbc;">ud</span><span style="color:#c1c0bf;">ec</span><span style="color:#cacaca;">ty</span><span style="color:#d9d9d8;">pe</span><span style="color:#e9e9e9;">.h</span><span style="color:#f8f8f8;">#i</span><span style="color:#fefefc;">ncludelimits</span><span style="color:#c4c4c3;">.h</span><span style="color:#0e0e0f;">/*</span><span style="color:#030305;">*O</span><span style="color:#020204;">riginalworkbyJef</span><span style="color:#070709;">fG</span><span style="color:#4b4b4c;">ar</span><span style="color:#fdfdfb;">zi</span><span style="color:#fefefc;">k**Externalfilelists,symlink,pipeandfifosupportbyT
hayneHarbaugh*HardlinksupportbyLucianoRocha*/#definexstr(s)#</span><span style="color:#fdfdfb;">s#</span><span style="color:#6c6c6d;">de</span><span style="color:#171717;">fi</span><span style="color:#0a0a0a;">ne</span><span style="color:#020204;">st</span><span style="color:#313132;">r(</span><span style="color:#e9e9e9;">s)</span><span style="color:#fefefc;">xs</span><span style="color:#fbfbfb;">tr</span><span style="color:#efefef;">(s</span><span style="color:#cccbcb;">)s</span><span style="color:#bebdbc;">ta</span><span style="color:#bebebd;">ti</span><span style="color:#bfbebd;">cu</span><span style="color:#bebebd;">nsig</span><span style="color:#bebdbd;">nedi</span><span style="color:#bebdbc;">nt</span><span style="color:#c4c3c3;">of</span><span style="color:#d2d2d1;">fs</span><span style="color:#e3e3e2;">et</span><span style="color:#f2f2f2;">;s</span><span style="color:#fafafa;">ta</span><span style="color:#fefefc;">ticunsignedint</span><span style="color:#fcfcfa;">in</span><span style="color:#5d5d5d;">o=</span><span style="color:#030305;">72</span><span style="color:#020204;">1;structfile_handl</span><span style="color:#0a0a0b;">er</span><span style="color:#aaaaaa;">{c</span><span style="color:#fefefc;">onstchar*type;int(*handler)(constchar*line);};stat
icvoidpush_string(constchar*name){unsignedintname_len=strlen</span><span style="color:#9c9c9c;">(n</span><span style="color:#09090a;">am</span><span style="color:#141414;">e)</span><span style="color:#09090a;">+1;f</span><span style="color:#b1b1b1;">pu</span><span style="color:#fbfbfa;">ts</span><span style="color:#fefefc;">(nam</span><span style="color:#fdfdfb;">e,</span><span style="color:#e4e4e4;">st</span><span style="color:#c0c0bf;">do</span><span style="color:#bebdbc;">ut);pu</span><span style="color:#bebdbd;">tcha</span><span style="color:#bebebd;">r(</span><span style="color:#cac9c9;">0)</span><span style="color:#dddddd;">;o</span><span style="color:#eeeeee;">ff</span><span style="color:#f9f9f9;">se</span><span style="color:#fdfdfc;">t+</span><span style="color:#fefefc;">=name_len;}stati</span><span style="color:#fdfdfb;">cv</span><span style="color:#d3d3d3;">oi</span><span style="color:#0e0e0f;">dp</span><span style="color:#020204;">ush_pad(void){while(</span><span style="color:#19191a;">of</span><span style="color:#eeeeec;">fs</span><span style="color:#fefefc;">et3){putchar(0);offset++;}}staticvoidpush_rest(c
onstchar*name){unsignedintname_len=strlen(name)+1;unsigned</span><span style="color:#cececd;">in</span><span style="color:#101012;">tt</span><span style="color:#020204;">mp</span><span style="color:#040404;">_o</span><span style="color:#040405;">fs</span><span style="color:#595959;">;f</span><span style="color:#f8f8f8;">pu</span><span style="color:#fefefc;">ts(name,</span><span style="color:#f5f5f5;">st</span><span style="color:#d7d7d7;">do</span><span style="color:#c4c4c3;">ut</span><span style="color:#c0bfbf;">);</span><span style="color:#bebdbc;">pu</span><span style="color:#bebebd;">tc</span><span style="color:#c2c1c2;">ha</span><span style="color:#d2d2d3;">r(</span><span style="color:#e9e9e9;">0)</span><span style="color:#f6f6f7;">;o</span><span style="color:#fcfcfc;">ff</span><span style="color:#fefefc;">set+=name_len;tmp_ofs=</span><span style="color:#fdfdfc;">na</span><span style="color:#4e4e4e;">me</span><span style="color:#020204;">_len+110;while(tmp_ofs</span><span style="color:#6a6a6b;">3)</span><span style="color:#fefefc;">{putchar(0);offset++;tmp_ofs++;}}staticvoidpush_
hdr(constchar*s){fputs(s,stdout);offset+=110;}staticvoid</span><span style="color:#e7e7e6;">cp</span><span style="color:#252527;">io</span><span style="color:#020204;">_trail</span><span style="color:#151516;">er</span><span style="color:#d2d2d1;">(v</span><span style="color:#fefefc;">oid){chars[2</span><span style="color:#fafaf9;">56</span><span style="color:#ededed;">];</span><span style="color:#dadadb;">co</span><span style="color:#d6d6d6;">ns</span><span style="color:#dedede;">tc</span><span style="color:#e9e9e8;">ha</span><span style="color:#f5f5f5;">rn</span><span style="color:#fcfcfb;">am</span><span style="color:#fefefc;">e[]="TRAILER!!!";sprintf(s,"</span><span style="color:#b5b5b4;">%s</span><span style="color:#030304;">%0</span><span style="color:#020204;">8X%08X%08lX%08lX%08X</span><span style="color:#040406;">%0</span><span style="color:#b3b3b3;">8l</span><span style="color:#fefefc;">X""%08X%08X%08X%08X%08X%08X%08X","070701",/*ma
gic*/0,/*ino*/0,/*mode*/(long)0,/*uid*/(long)0,/*gid*/</span><span style="color:#f8f8f7;">1,</span><span style="color:#4d4d4e;">/*</span><span style="color:#020204;">nlink*/(</span><span style="color:#747474;">lo</span><span style="color:#fdfdfb;">ng</span><span style="color:#fefefc;">)0,/*mtime*/0,</span><span style="color:#fdfdfc;">/*</span><span style="color:#f3f3f3;">file</span><span style="color:#fbfbfa;">si</span><span style="color:#fdfdfc;">ze</span><span style="color:#fefefc;">*/0,/*major*/0,/*minor*/0,/*rmaj</span><span style="color:#f0f0f0;">or</span><span style="color:#121212;">*/</span><span style="color:#020204;">0,/*rminor*/(unsigned)</span><span style="color:#18181a;">st</span><span style="color:#cecece;">rl</span><span style="color:#fefefc;">en(name)+1,/*namesize*/0);/*chksum*/push_hdr
(s);push_rest(name);while(offset%512){putchar(0);off</span><span style="color:#fdfdfb;">se</span><span style="color:#7e7e7e;">t+</span><span style="color:#030305;">+;</span><span style="color:#020204;">}}stat</span><span style="color:#181818;">ic</span><span style="color:#dbdbdc;">in</span><span style="color:#fcfcfc;">tc</span><span style="color:#fefefc;">pio_mkslink(cons</span><span style="color:#fafafb;">tc</span><span style="color:#fcfcfc;">ha</span><span style="color:#fefefc;">r*name,constchar*target,unsignedintm</span><span style="color:#fafafb;">od</span><span style="color:#434343;">e,</span><span style="color:#040405;">ui</span><span style="color:#020204;">d_tuid,gid_tgid){chars</span><span style="color:#232325;">[2</span><span style="color:#e5e5e3;">56</span><span style="color:#fefefc;">];time_tmtime=time(NULL);sprintf(s,"%s%08X
%08X%08lX%08lX%08X%08lX""%08X%08X%08X%08X%08X%08X%08</span><span style="color:#a6a6a5;">X"</span><span style="color:#0a0a0b;">,"</span><span style="color:#020204;">070701</span><span style="color:#030305;">",</span><span style="color:#666666;">/*</span><span style="color:#ebebea;">ma</span><span style="color:#fbfbfb;">gi</span><span style="color:#fefefc;">c*/ino++,/*ino*/</span><span style="color:#fdfdfc;">S_IF</span><span style="color:#fefefc;">LNK|mode,/*mode*/(long)uid,/*uid*/</span><span style="color:#fcfcfb;">(l</span><span style="color:#f8f8f8;">on</span><span style="color:#797979;">g)</span><span style="color:#050506;">gi</span><span style="color:#020204;">d,/*gid*/1,/*nlink*/(lon</span><span style="color:#383839;">g)</span><span style="color:#efefed;">mt</span><span style="color:#fefefc;">ime,/*mtime*/(unsigned)strlen(target)+1,
/*filesize*/3,/*major*/1,/*minor*/0,/*rmajor*/0,/*</span><span style="color:#bcbcbc;">rm</span><span style="color:#151517;">in</span><span style="color:#020204;">or*/(uns</span><span style="color:#101010;">ig</span><span style="color:#9f9e9f;">ne</span><span style="color:#e8e8e7;">d)</span><span style="color:#fafafb;">st</span><span style="color:#fefefc;">rlen(name)+1</span><span style="color:#fdfdfc;">,/</span><span style="color:#fefefc;">*n</span><span style="color:#fcfcfc;">am</span><span style="color:#f8f8f9;">es</span><span style="color:#fdfdfc;">iz</span><span style="color:#fefefc;">e*/0);/*chksum*/push_hdr(s);</span><span style="color:#fcfcfb;">pu</span><span style="color:#f6f6f6;">sh</span><span style="color:#f4f4f4;">_s</span><span style="color:#f2f2f1;">tr</span><span style="color:#b3b3b3;">in</span><span style="color:#050505;">g(</span><span style="color:#020204;">name);push_pad();push_stri</span><span style="color:#4b4b4c;">ng</span><span style="color:#f3f3f1;">(t</span><span style="color:#fefefc;">arget);push_pad();return0;}staticintcp
io_mkslink_line(constchar*line){charname[PATH_MA</span><span style="color:#dcdcda;">X+</span><span style="color:#212122;">1]</span><span style="color:#030304;">;c</span><span style="color:#020204;">hartarge</span><span style="color:#171717;">t[</span><span style="color:#a8a8a8;">PA</span><span style="color:#d9d9d9;">TH</span><span style="color:#f7f7f7;">_M</span><span style="color:#fbfbfc;">AX</span><span style="color:#fefefc;">+1];unsi</span><span style="color:#fdfdfc;">gn</span><span style="color:#fcfcfb;">ed</span><span style="color:#f9f9f8;">in</span><span style="color:#f5f5f5;">tm</span><span style="color:#ededed;">od</span><span style="color:#f6f6f6;">e;</span><span style="color:#f9f9f9;">in</span><span style="color:#fcfcfc;">tu</span><span style="color:#fdfdfc;">id;intgid;</span><span style="color:#fefefc;">in</span><span style="color:#fdfdfb;">trc=</span><span style="color:#fcfcfb;">-1</span><span style="color:#fbfbfb;">;i</span><span style="color:#f9f9f9;">f(</span><span style="color:#f5f5f6;">5!</span><span style="color:#ececec;">=s</span><span style="color:#e3e3e3;">sc</span><span style="color:#e2e2e2;">an</span><span style="color:#e6e6e6;">f(</span><span style="color:#d9d9d9;">li</span><span style="color:#0d0d0d;">ne</span><span style="color:#040406;">,"</span><span style="color:#020204;">%"str(PATH_MAX)"s%"str(PAT</span><span style="color:#535355;">H_</span><span style="color:#f6f6f4;">MA</span><span style="color:#fefefc;">X)"s%o%d%d",name,target,mode,uid,gid
)){fprintf(stderr,"Unrecognizeddirformat'%s'",</span><span style="color:#fbfbfa;">li</span><span style="color:#474748;">ne</span><span style="color:#020204;">);gotofail</span><span style="color:#050506;">;}</span><span style="color:#343434;">rc</span><span style="color:#a2a2a1;">=c</span><span style="color:#bdbdbd;">pi</span><span style="color:#dedede;">o_</span><span style="color:#f1f1f1;">mk</span><span style="color:#f4f4f4;">sl</span><span style="color:#f8f8f8;">in</span><span style="color:#fbfbfb;">k(</span><span style="color:#fbfbfc;">na</span><span style="color:#f8f8f9;">me</span><span style="color:#efefef;">,t</span><span style="color:#e4e4e4;">arge</span><span style="color:#e3e3e3;">t,</span><span style="color:#e2e2e2;">mo</span><span style="color:#e9e9e9;">de</span><span style="color:#f5f5f5;">,u</span><span style="color:#f9f9fb;">id,g</span><span style="color:#fafafb;">id);</span><span style="color:#f9f9f9;">fa</span><span style="color:#f3f3f3;">il</span><span style="color:#e9e9e9;">:r</span><span style="color:#e4e4e4;">et</span><span style="color:#e1e1e1;">ur</span><span style="color:#dedede;">nr</span><span style="color:#d9d9d9;">c;</span><span style="color:#d5d5d6;">}s</span><span style="color:#d3d3d3;">ta</span><span style="color:#cccccc;">ti</span><span style="color:#cacaca;">ci</span><span style="color:#d2d2d1;">nt</span><span style="color:#e6e6e6;">cp</span><span style="color:#393939;">io</span><span style="color:#050506;">_m</span><span style="color:#020204;">kgeneric(constchar*name,un</span><span style="color:#0a0a0c;">si</span><span style="color:#8a8a8a;">gn</span><span style="color:#fdfdfb;">ed</span><span style="color:#fefefc;">intmode,uid_tuid,gid_tgid){chars[2
56];time_tmtime=time(NULL);sprintf(s,"%s%08X%0</span><span style="color:#b4b4b4;">8X</span><span style="color:#060608;">%0</span><span style="color:#020204;">8lX%08lX%0</span><span style="color:#0e0e0f;">8X</span><span style="color:#4d4d4e;">%0</span><span style="color:#9f9f9f;">8l</span><span style="color:#ababaa;">X"</span><span style="color:#c3c3c3;">"%</span><span style="color:#d7d7d8;">08</span><span style="color:#e4e4e4;">X%</span><span style="color:#f3f3f2;">08</span><span style="color:#fafafb;">X%</span><span style="color:#fcfcfc;">08</span><span style="color:#fbfbfb;">X%</span><span style="color:#fafafa;">08</span><span style="color:#f2f2f2;">X%</span><span style="color:#dedede;">08</span><span style="color:#e4e4e4;">X%</span><span style="color:#f2f2f2;">08</span><span style="color:#f7f7f6;">X%</span><span style="color:#fcfcfb;">08</span><span style="color:#fdfdfc;">X","0707</span><span style="color:#fbfbfb;">01</span><span style="color:#f1f1f1;">",</span><span style="color:#e2e2e2;">/*</span><span style="color:#d6d6d6;">ma</span><span style="color:#c9c9c9;">gi</span><span style="color:#c4c4c4;">c*</span><span style="color:#c3c3c3;">/i</span><span style="color:#c2c2c3;">no++,/*i</span><span style="color:#c3c3c3;">no</span><span style="color:#d3d3d3;">*/</span><span style="color:#cdcdcd;">mo</span><span style="color:#222222;">de</span><span style="color:#020204;">,/*m</span><span style="color:#030305;">od</span><span style="color:#0c0c0d;">e*</span><span style="color:#040405;">/(</span><span style="color:#020204;">long)uid,/*uid*/(l</span><span style="color:#0e0e0f;">on</span><span style="color:#c5c5c5;">g)</span><span style="color:#fefefc;">gid,/*gid*/2,/*nlink*/(long)mtime,
/*mtime*/0,/*filesize*/3,/*major*/1,/*minor*</span><span style="color:#fafaf8;">/0</span><span style="color:#38383b;">,/</span><span style="color:#020204;">*rmajor*/0,/</span><span style="color:#131313;">*r</span><span style="color:#5b5b5b;">mi</span><span style="color:#a7a7a6;">no</span><span style="color:#bebebd;">r*</span><span style="color:#d8d8d8;">/(</span><span style="color:#eaeaea;">un</span><span style="color:#f5f5f5;">si</span><span style="color:#fbfbfb;">gn</span><span style="color:#fdfdfc;">ed)strle</span><span style="color:#f7f7f7;">n(</span><span style="color:#e7e7e6;">na</span><span style="color:#f6f6f6;">me</span><span style="color:#fdfdfc;">)+1,/*namesize*/</span><span style="color:#fcfcfb;">0)</span><span style="color:#f8f8f8;">;/</span><span style="color:#f2f2f2;">*c</span><span style="color:#e9e9e9;">hk</span><span style="color:#dedede;">su</span><span style="color:#d5d5d5;">m*</span><span style="color:#cdcdcc;">/p</span><span style="color:#c6c6c6;">us</span><span style="color:#c2c2c2;">h_</span><span style="color:#c0c0c0;">hdr(</span><span style="color:#c3c3c3;">s)</span><span style="color:#e0e0e0;">;p</span><span style="color:#c0c0c0;">us</span><span style="color:#0d0d0e;">h_</span><span style="color:#020204;">re</span><span style="color:#070708;">st</span><span style="color:#3f3f3f;">(n</span><span style="color:#333333;">am</span><span style="color:#0b0b0c;">e)</span><span style="color:#030304;">;r</span><span style="color:#020204;">eturn0;}enumgene</span><span style="color:#555555;">ri</span><span style="color:#fefefc;">c_types{GT_DIR,GT_PIPE,GT_SOCK};st
ructgeneric_type{constchar*type;mode_tmode;}</span><span style="color:#b6b6b6;">;s</span><span style="color:#040406;">ta</span><span style="color:#020204;">ticstructg</span><span style="color:#030305;">en</span><span style="color:#1e1e1e;">er</span><span style="color:#90908f;">ic</span><span style="color:#c9c9c9;">_t</span><span style="color:#e5e5e4;">yp</span><span style="color:#f5f5f5;">eg</span><span style="color:#fbfbfb;">en</span><span style="color:#fdfdfc;">eric_type_ta</span><span style="color:#f7f7f7;">bl</span><span style="color:#ebebeb;">e[</span><span style="color:#fafafa;">]=</span><span style="color:#fdfdfc;">{[GT_DIR]={.type="dir",.</span><span style="color:#fcfcfb;">mo</span><span style="color:#f8f8f8;">de</span><span style="color:#f1f1f1;">=S</span><span style="color:#e6e6e6;">_I</span><span style="color:#d8d8d8;">FD</span><span style="color:#cbcbcb;">IR</span><span style="color:#c3c3c3;">},</span><span style="color:#c0c0c0;">[G</span><span style="color:#cccccc;">T_</span><span style="color:#efefef;">PI</span><span style="color:#888889;">PE</span><span style="color:#020204;">]={.</span><span style="color:#070709;">ty</span><span style="color:#171718;">pe</span><span style="color:#353535;">="</span><span style="color:#1d1d1d;">pi</span><span style="color:#060607;">pe</span><span style="color:#020204;">",.mode=S_IFIF</span><span style="color:#08080a;">O}</span><span style="color:#dbdbd9;">,[</span><span style="color:#fefefc;">GT_SOCK]={.type="sock",.mode=S_I
FSOCK}};staticintcpio_mkgeneric_line(constch</span><span style="color:#7b7b7c;">ar</span><span style="color:#020204;">*line,</span><span style="color:#111112;">en</span><span style="color:#171717;">um</span><span style="color:#020204;">ge</span><span style="color:#0b0b0c;">ne</span><span style="color:#555555;">ri</span><span style="color:#cbcbcc;">c_</span><span style="color:#eaeaea;">ty</span><span style="color:#f9f9f9;">pe</span><span style="color:#fcfcfc;">sg</span><span style="color:#fdfdfc;">t){charname[PA</span><span style="color:#fafafa;">TH</span><span style="color:#f6f6f6;">_M</span><span style="color:#fcfcfc;">AX</span><span style="color:#fdfdfc;">+1];unsignedintmode;intuid;int</span><span style="color:#fcfcfc;">gi</span><span style="color:#f9f9f8;">d;</span><span style="color:#ececec;">in</span><span style="color:#dbdbdb;">tr</span><span style="color:#cacaca;">c=</span><span style="color:#c2c2c2;">-1</span><span style="color:#d4d4d4;">;i</span><span style="color:#f1f1f2;">f(</span><span style="color:#343435;">4!</span><span style="color:#020204;">=sscan</span><span style="color:#0a0a0b;">f(</span><span style="color:#363636;">li</span><span style="color:#282828;">ne</span><span style="color:#040406;">,"</span><span style="color:#020204;">%"str(PATH_MAX</span><span style="color:#767676;">)"</span><span style="color:#fefefc;">s%o%d%d",name,mode,uid,gid)){fpr
intf(stderr,"Unrecognized%sformat'%s'",line,</span><span style="color:#38383a;">ge</span><span style="color:#020204;">neri</span><span style="color:#1a1a1b;">c_</span><span style="color:#313031;">ty</span><span style="color:#09090a;">pe</span><span style="color:#020204;">_t</span><span style="color:#181819;">ab</span><span style="color:#c0c0c0;">le</span><span style="color:#ededed;">[g</span><span style="color:#fbfbfa;">t]</span><span style="color:#fdfdfc;">.type);gotofail;}m</span><span style="color:#fbfbfc;">od</span><span style="color:#fcfcfc;">e|</span><span style="color:#fdfdfc;">=generic_type_table[gt].mode;rc=cpio</span><span style="color:#fcfcfc;">_m</span><span style="color:#f6f6f7;">kg</span><span style="color:#e6e6e6;">en</span><span style="color:#cdcdcd;">er</span><span style="color:#c4c4c4;">ic</span><span style="color:#e4e4e5;">(n</span><span style="color:#b1b1b2;">am</span><span style="color:#030305;">e,</span><span style="color:#020204;">mode,u</span><span style="color:#050506;">id</span><span style="color:#323232;">,g</span><span style="color:#1a1a1a;">id</span><span style="color:#020204;">);fail:returnr</span><span style="color:#161618;">c;</span><span style="color:#f5f5f3;">}s</span><span style="color:#fefefc;">taticintcpio_mkdir_line(constc
har*line){returncpio_mkgeneric_line(line,G</span><span style="color:#ebebe9;">T_</span><span style="color:#0e0e0f;">DI</span><span style="color:#020204;">R)</span><span style="color:#040405;">;}</span><span style="color:#3d3d3e;">st</span><span style="color:#08080a;">at</span><span style="color:#020204;">icin</span><span style="color:#656565;">tc</span><span style="color:#f5f5f5;">pi</span><span style="color:#fcfcfb;">o_</span><span style="color:#fdfdfc;">mkpipe_line(constchar*line){returncpio_mkgeneric_line(line,GT_PI</span><span style="color:#fafafa;">PE</span><span style="color:#e9e9e9;">);</span><span style="color:#cfcfcf;">}s</span><span style="color:#cacaca;">ta</span><span style="color:#f1f1f1;">ti</span><span style="color:#353536;">ci</span><span style="color:#020204;">ntcp</span><span style="color:#050506;">io</span><span style="color:#090909;">_m</span><span style="color:#080808;">ks</span><span style="color:#353535;">oc</span><span style="color:#0a0a0b;">k_</span><span style="color:#020204;">line(constchar</span><span style="color:#9e9e9e;">*l</span><span style="color:#fefefc;">ine){returncpio_mkgeneric_line
(line,GT_SOCK);}staticintcpio_mknod(constc</span><span style="color:#979796;">ha</span><span style="color:#020204;">r*na</span><span style="color:#131314;">me</span><span style="color:#2c2c2d;">,u</span><span style="color:#020204;">nsig</span><span style="color:#121213;">ne</span><span style="color:#d7d7d7;">di</span><span style="color:#fdfdfc;">ntmode,uid_tuid,gid_tgid,chardev_type,unsignedintmaj,unsignedintmin){c</span><span style="color:#fbfbfa;">ha</span><span style="color:#e9e9e9;">rs</span><span style="color:#cfcfcf;">[2</span><span style="color:#dcdcdc;">56</span><span style="color:#a8a8a9;">];</span><span style="color:#020204;">ti</span><span style="color:#030304;">me</span><span style="color:#131314;">_t</span><span style="color:#242424;">mt</span><span style="color:#1b1b1b;">im</span><span style="color:#181818;">e=</span><span style="color:#333333;">ti</span><span style="color:#040406;">me</span><span style="color:#020204;">(NULL);if(de</span><span style="color:#404041;">v_</span><span style="color:#fdfdfb;">ty</span><span style="color:#fefefc;">pe=='b')mode|=S_IFBLK;elsemo
de|=S_IFCHR;sprintf(s,"%s%08X%08X%08lX%08l</span><span style="color:#464646;">X%</span><span style="color:#020204;">08</span><span style="color:#040405;">X%</span><span style="color:#403f3f;">08</span><span style="color:#0a0a0b;">lX</span><span style="color:#020204;">""</span><span style="color:#030305;">%0</span><span style="color:#767677;">8X</span><span style="color:#fcfcfc;">%0</span><span style="color:#fdfdfc;">8X%08X%08X%08X%08X%08X","070701",/*magic*/ino++,/*ino*/mode,/*mode*/(lon</span><span style="color:#fbfbfa;">g)</span><span style="color:#f0f0f0;">ui</span><span style="color:#eaeaea;">d,</span><span style="color:#f0f0f0;">/*</span><span style="color:#161618;">ui</span><span style="color:#040405;">d*</span><span style="color:#1f1f1f;">/(</span><span style="color:#3f3e3e;">lo</span><span style="color:#383838;">ng</span><span style="color:#181818;">)g</span><span style="color:#2c2c2c;">id</span><span style="color:#171718;">,/</span><span style="color:#020204;">*gid*/1,/*nl</span><span style="color:#0c0c0d;">in</span><span style="color:#dadad9;">k*</span><span style="color:#fefefc;">/(long)mtime,/*mtime*/0,/*fi
lesize*/3,/*major*/1,/*minor*/maj,/*rmaj</span><span style="color:#e7e7e6;">or</span><span style="color:#09090a;">*/</span><span style="color:#020204;">mi</span><span style="color:#171718;">n,</span><span style="color:#373737;">/*</span><span style="color:#020204;">rmin</span><span style="color:#141415;">or</span><span style="color:#e2e2e1;">*/</span><span style="color:#fdfdfc;">(unsigned)strlen(name)+1,/*namesize*/0);/*chksum*/push_hdr(s);push_rest(name);re</span><span style="color:#fcfcfc;">tu</span><span style="color:#5e5e5e;">rn</span><span style="color:#0d0d0d;">0;</span><span style="color:#282828;">}s</span><span style="color:#434343;">ta</span><span style="color:#373737;">ti</span><span style="color:#1a1a1a;">ci</span><span style="color:#0c0c0d;">nt</span><span style="color:#3b3b3b;">cp</span><span style="color:#060607;">io</span><span style="color:#020204;">_mknod_line(</span><span style="color:#848484;">co</span><span style="color:#fefefc;">nstchar*line){charname[PATH_
MAX+1];unsignedintmode;intuid;intgid;cha</span><span style="color:#959594;">rd</span><span style="color:#020204;">ev_t</span><span style="color:#373737;">yp</span><span style="color:#09090b;">e;</span><span style="color:#020204;">un</span><span style="color:#050507;">si</span><span style="color:#7a7a79;">gn</span><span style="color:#fdfdfc;">edintmaj;unsignedintmin;in</span><span style="color:#f8f8f8;">tr</span><span style="color:#fafafa;">c=</span><span style="color:#fdfdfc;">-1;if(7!=sscanf(line,"%"str(PATH_MAX)"s%o%d%d%c%u%u",n</span><span style="color:#a0a0a1;">am</span><span style="color:#121212;">e,</span><span style="color:#1f1f20;">mo</span><span style="color:#272727;">de</span><span style="color:#1a1a1a;">,u</span><span style="color:#0a0a0a;">id</span><span style="color:#030304;">,g</span><span style="color:#363635;">id</span><span style="color:#1e1e1f;">,d</span><span style="color:#020204;">ev_type,maj,</span><span style="color:#2f2f30;">mi</span><span style="color:#fcfcfa;">n)</span><span style="color:#fefefc;">){fprintf(stderr,"Unrecogn
izednodformat'%s'",line);gotofail;}rc=cp</span><span style="color:#39393a;">io</span><span style="color:#020204;">_m</span><span style="color:#0e0e0f;">kn</span><span style="color:#353535;">od</span><span style="color:#020204;">(nam</span><span style="color:#121212;">e,</span><span style="color:#dbdbda;">mo</span><span style="color:#fdfdfc;">de,uid,gid,dev_type,maj,</span><span style="color:#fcfcfc;">mi</span><span style="color:#ebebeb;">n)</span><span style="color:#f5f5f5;">;f</span><span style="color:#fdfdfc;">ail:returnrc;}staticintcpio_mkfile(constchar*name,cons</span><span style="color:#d8d8d8;">tc</span><span style="color:#070708;">har*</span><span style="color:#060607;">lo</span><span style="color:#030305;">ca</span><span style="color:#020204;">tion</span><span style="color:#101010;">,u</span><span style="color:#363636;">ns</span><span style="color:#020204;">ignedintmode</span><span style="color:#040406;">,u</span><span style="color:#cbcbca;">id</span><span style="color:#fefefc;">_tuid,gid_tgid,unsignedint
nlinks){chars[256];char*filebuf=NULL;s</span><span style="color:#cccccb;">tr</span><span style="color:#040406;">uc</span><span style="color:#030204;">ts</span><span style="color:#2f2f2f;">ta</span><span style="color:#141415;">tb</span><span style="color:#020204;">uf</span><span style="color:#050506;">;l</span><span style="color:#5b5b5b;">on</span><span style="color:#fcfcfc;">gs</span><span style="color:#fdfdfc;">ize;intfile=-1;intretval</span><span style="color:#fafaf9;">;i</span><span style="color:#e5e5e6;">nt</span><span style="color:#f6f6f5;">rc</span><span style="color:#fdfdfc;">=-1;intnamesize;inti;mode|=S_IFREG;retval=stat(locatio</span><span style="color:#f9f9f9;">n,</span><span style="color:#202021;">bu</span><span style="color:#020204;">f);if(retv</span><span style="color:#030304;">al</span><span style="color:#3a3a3a;">){</span><span style="color:#050506;">fp</span><span style="color:#020204;">rintf(stderr</span><span style="color:#888887;">,"</span><span style="color:#fefefc;">File%scouldnotbelocated\n"
,location);gotoerror;}file=open(locati</span><span style="color:#626262;">on</span><span style="color:#020204;">,O</span><span style="color:#060506;">_R</span><span style="color:#3d3d3d;">DO</span><span style="color:#030304;">NL</span><span style="color:#020204;">Y)</span><span style="color:#0f0f10;">;i</span><span style="color:#bebebe;">f(</span><span style="color:#fdfdfc;">file0){fprintf(stderr,"Fil</span><span style="color:#f8f8f8;">e%</span><span style="color:#e4e4e4;">sc</span><span style="color:#fafafa;">ou</span><span style="color:#fdfdfc;">ldnotbeopenedforreading\n",location);gotoerror;}filebuf=</span><span style="color:#4c4c4d;">ma</span><span style="color:#020204;">lloc(buf.st_</span><span style="color:#3b3b3b;">si</span><span style="color:#101011;">ze</span><span style="color:#020204;">);if(!filebu</span><span style="color:#484849;">f)</span><span style="color:#fefefc;">{fprintf(stderr,"outofmemo
ry\n");gotoerror;}retval=read(file,f</span><span style="color:#e1e1e0;">il</span><span style="color:#0c0c0e;">eb</span><span style="color:#040204;">uf</span><span style="color:#171717;">,b</span><span style="color:#303030;">uf</span><span style="color:#020204;">.st_</span><span style="color:#353536;">si</span><span style="color:#f8f8f7;">ze</span><span style="color:#fdfdfc;">);if(retval0){fprintf(stde</span><span style="color:#f5f5f5;">rr</span><span style="color:#e4e4e4;">,"</span><span style="color:#fafafa;">Ca</span><span style="color:#fdfdfc;">nnotread%sfile\n",location);gotoerror;}size=0;for(i=1;i=</span><span style="color:#6d6d6e;">nl</span><span style="color:#020204;">inks;i++){/*</span><span style="color:#3c3b3c;">da</span><span style="color:#0c0c0d;">ta</span><span style="color:#020204;">goesonlastli</span><span style="color:#0f0f10;">nk</span><span style="color:#f8f8f6;">*/</span><span style="color:#fefefc;">if(i==nlinks)size=buf.st
_size;namesize=strlen(name)+1;spri</span><span style="color:#fdfdfb;">nt</span><span style="color:#636263;">f(</span><span style="color:#020204;">s,</span><span style="color:#030204;">"%</span><span style="color:#2b2b2b;">s%</span><span style="color:#0f0f11;">08</span><span style="color:#020204;">X%</span><span style="color:#050507;">08</span><span style="color:#828282;">X%</span><span style="color:#fdfdfc;">08lX%08lX%08X%08lX""%08lX%08</span><span style="color:#efefef;">X%</span><span style="color:#e1e1e1;">08</span><span style="color:#f8f8f8;">X%</span><span style="color:#fdfdfc;">08X%08X%08X%08X","070701",/*magic*/ino,/*ino*/mode,/*mod</span><span style="color:#8d8d8d;">e*</span><span style="color:#020204;">/(long)uid,/</span><span style="color:#3b3b3c;">*u</span><span style="color:#070708;">id</span><span style="color:#020204;">*/(long)gid,/*</span><span style="color:#cdcdcc;">gi</span><span style="color:#fefefc;">d*/nlinks,/*nlink*/(long
)buf.st_mtime,/*mtime*/size,/*file</span><span style="color:#cdcdcc;">si</span><span style="color:#0b0b0d;">ze</span><span style="color:#020204;">*/</span><span style="color:#050506;">3,</span><span style="color:#373737;">/*</span><span style="color:#020204;">majo</span><span style="color:#0b0b0c;">r*</span><span style="color:#c8c8c8;">/1</span><span style="color:#fdfdfc;">,/*minor*/0,/*rmajor*/0,/*rm</span><span style="color:#eeeeee;">in</span><span style="color:#e1e1e0;">or</span><span style="color:#f9f9f9;">*/</span><span style="color:#fdfdfc;">namesize,/*namesize*/0);/*chksum*/push_hdr(s);push_strin</span><span style="color:#9e9e9f;">g(</span><span style="color:#020204;">name);push_p</span><span style="color:#333233;">ad</span><span style="color:#050507;">()</span><span style="color:#020204;">;if(size){fwri</span><span style="color:#9f9f9e;">te</span><span style="color:#fefefc;">(filebuf,size,1,stdout);
offset+=size;push_pad();}name+=n</span><span style="color:#fbfbf9;">am</span><span style="color:#515152;">es</span><span style="color:#020204;">ize;</span><span style="color:#080809;">}i</span><span style="color:#343434;">no</span><span style="color:#020204;">++;r</span><span style="color:#1a1a1b;">c=</span><span style="color:#f2f2f1;">0;</span><span style="color:#fdfdfc;">error:if(filebuf)free(filebu</span><span style="color:#ededed;">f)</span><span style="color:#e1e1e1;">;i</span><span style="color:#f8f8f8;">f(</span><span style="color:#fdfdfc;">file=0)close(file);returnrc;}staticintcpio_mkfile_line(c</span><span style="color:#b2b2b2;">on</span><span style="color:#020204;">stchar*line)</span><span style="color:#313131;">{c</span><span style="color:#030304;">ha</span><span style="color:#020204;">rname[PATH_MAX</span><span style="color:#757575;">+1</span><span style="color:#fefefc;">];char*dname=NULL;/*mall
oc'edbufferforhardlinks*/charloc</span><span style="color:#adadac;">at</span><span style="color:#08080a;">io</span><span style="color:#020204;">n[PA</span><span style="color:#0b0b0c;">TH</span><span style="color:#3b3a3a;">_M</span><span style="color:#020204;">AX+1</span><span style="color:#4f4f4f;">];</span><span style="color:#fdfdfc;">unsignedintmode;intuid;intgid;</span><span style="color:#e7e7e7;">in</span><span style="color:#e0e0e0;">tn</span><span style="color:#f7f7f7;">li</span><span style="color:#fdfdfc;">nks=1;intend=0,dname_len=0;intrc=-1;if(5sscanf(line,"%"s</span><span style="color:#bfbfbf;">tr</span><span style="color:#020204;">(PATH_MAX)</span><span style="color:#040406;">"s</span><span style="color:#313131;">%"</span><span style="color:#020204;">str(PATH_MAX)"s%</span><span style="color:#525253;">o%</span><span style="color:#fefefc;">d%d%n",name,location,mod
e,uid,gid,end)){fprintf(stderr</span><span style="color:#ededec;">,"</span><span style="color:#28282b;">Un</span><span style="color:#020204;">recogn</span><span style="color:#0c0c0d;">iz</span><span style="color:#414141;">ed</span><span style="color:#020204;">file</span><span style="color:#6b6b6c;">fo</span><span style="color:#fcfcfb;">rm</span><span style="color:#fdfdfc;">at'%s'",line);gotofail;}if(e</span><span style="color:#e6e6e6;">nd</span><span style="color:#e0e0e0;">is</span><span style="color:#f7f7f7;">gr</span><span style="color:#fdfdfc;">aph(line[end])){intlen;intnend;dname=malloc(strlen(line)</span><span style="color:#c7c7c7;">);</span><span style="color:#020204;">if(!dname)</span><span style="color:#0c0c0d;">{f</span><span style="color:#2c2c2c;">pr</span><span style="color:#020204;">intf(stderr,"out</span><span style="color:#444445;">of</span><span style="color:#fefefc;">memory(%d)\n",dname_len)
;gotofail;}dname_len=strlen(na</span><span style="color:#8b8b8c;">me</span><span style="color:#020204;">)+1;memc</span><span style="color:#111112;">py</span><span style="color:#444444;">(d</span><span style="color:#020204;">name</span><span style="color:#848484;">,n</span><span style="color:#fdfdfc;">ame,dname_len);do{nend=0;if(ss</span><span style="color:#e6e6e6;">ca</span><span style="color:#e0e0e0;">nf</span><span style="color:#f8f8f9;">(l</span><span style="color:#fdfdfc;">ine+end,"%"str(PATH_MAX)"s%n",name,nend)1)break;len=strl</span><span style="color:#d0d0d0;">en</span><span style="color:#020204;">(name)+1;m</span><span style="color:#1e1e1f;">em</span><span style="color:#181818;">cp</span><span style="color:#020204;">y(dname+dname_le</span><span style="color:#333334;">n,</span><span style="color:#fefefc;">name,len);dname_len+=len
;nlinks++;end+=nend;}while(i</span><span style="color:#fdfdfb;">sg</span><span style="color:#303031;">ra</span><span style="color:#020204;">ph(lin</span><span style="color:#070708;">e[</span><span style="color:#232323;">en</span><span style="color:#4f4f4f;">d]</span><span style="color:#020204;">));}</span><span style="color:#969595;">el</span><span style="color:#fdfdfc;">se{dname=name;}rc=cpio_mkfile(</span><span style="color:#e4e4e4;">dnam</span><span style="color:#f9f9fa;">e,</span><span style="color:#fdfdfc;">location,mode,uid,gid,nlinks);fail:if(dname_len)free(dna</span><span style="color:#d3d3d2;">me</span><span style="color:#020204;">);returnrc</span><span style="color:#2c2c2c;">;}</span><span style="color:#060607;">vo</span><span style="color:#020204;">idusage(constcha</span><span style="color:#2c2c2e;">r*</span><span style="color:#fefefc;">prog){fprintf(stderr,"Us
age:\n""\t%scpio_list\n""\n"</span><span style="color:#f5f5f3;">"c</span><span style="color:#0a0a0c;">pi</span><span style="color:#020204;">o_list</span><span style="color:#121212;">is</span><span style="color:#3a3a3a;">af</span><span style="color:#717171;">il</span><span style="color:#040405;">ec</span><span style="color:#09090a;">on</span><span style="color:#afafb0;">ta</span><span style="color:#fdfdfc;">iningnewlineseparatedentries</span><span style="color:#fcfcfb;">th</span><span style="color:#e3e3e3;">at</span><span style="color:#e5e5e5;">\n</span><span style="color:#fafafa;">""</span><span style="color:#fdfdfc;">describethefilestobeincludedintheinitramfsarchive:\n""\n</span><span style="color:#d5d5d5;">""</span><span style="color:#030305;">#a</span><span style="color:#020204;">commen</span><span style="color:#040405;">t\</span><span style="color:#2e2e2e;">n"</span><span style="color:#030304;">"f</span><span style="color:#020204;">ilenamelocationm</span><span style="color:#333334;">od</span><span style="color:#fefefc;">euidgid[hardlinks]\n""di
rnamemodeuidgid\n""nodnamemo</span><span style="color:#dadad9;">de</span><span style="color:#030304;">ui</span><span style="color:#020204;">dgidde</span><span style="color:#040406;">v_</span><span style="color:#1b1b1c;">ty</span><span style="color:#5e5e5e;">pe</span><span style="color:#121213;">ma</span><span style="color:#0a0a0b;">jm</span><span style="color:#b6b6b6;">in</span><span style="color:#fdfdfc;">\n""slinknametargetmodeuidgi</span><span style="color:#fcfcfb;">d\</span><span style="color:#e3e3e3;">n"</span><span style="color:#e6e6e6;">"p</span><span style="color:#fafafa;">ip</span><span style="color:#fdfdfc;">enamemodeuidgid\n""socknamemodeuidgid\n""\n""namenameoft</span><span style="color:#cdcdcd;">he</span><span style="color:#040405;">fi</span><span style="color:#020204;">le/dir</span><span style="color:#1b1b1c;">/n</span><span style="color:#181818;">od</span><span style="color:#020204;">/etcinthearchive\n</span><span style="color:#474748;">""</span><span style="color:#fefefc;">locationlocationofthefil
einthecurrentfilesystem\n""t</span><span style="color:#d9d9d8;">ar</span><span style="color:#020204;">getlinktar</span><span style="color:#050507;">ge</span><span style="color:#212121;">t\</span><span style="color:#2a2a2a;">n"</span><span style="color:#0c0c0d;">"m</span><span style="color:#bcbcbc;">od</span><span style="color:#fdfdfc;">emode/permissionsofthefile\n</span><span style="color:#fcfcfb;">""</span><span style="color:#e3e3e3;">ui</span><span style="color:#e9e9e9;">du</span><span style="color:#fbfbfb;">se</span><span style="color:#fdfdfc;">rid(0=root)\n""gidgroupid(0=root)\n""dev_typedevicetype(</span><span style="color:#b6b6b5;">b=</span><span style="color:#020204;">block,</span><span style="color:#040406;">c=</span><span style="color:#2f2f2f;">ch</span><span style="color:#09090a;">ar</span><span style="color:#050506;">ac</span><span style="color:#050507;">te</span><span style="color:#030305;">r)</span><span style="color:#020204;">\n""majmajor</span><span style="color:#5c5b5c;">nu</span><span style="color:#fefefc;">mberofnod\n""minminornum
berofnod\n""hardlinksspacese</span><span style="color:#eaeae8;">pa</span><span style="color:#040406;">ra</span><span style="color:#020204;">tedl</span><span style="color:#030204;">is</span><span style="color:#030304;">to</span><span style="color:#020204;">fo</span><span style="color:#040406;">th</span><span style="color:#2b2b2b;">er</span><span style="color:#1e1e1f;">li</span><span style="color:#b3b3b3;">nk</span><span style="color:#fdfdfc;">stofile\n""\n""example:\n""#</span><span style="color:#fcfcfb;">As</span><span style="color:#e3e3e3;">im</span><span style="color:#e9e9e8;">pl</span><span style="color:#fbfbfb;">ei</span><span style="color:#fdfdfc;">nitramfs\n""dir/dev075500\n""nod/dev/console060000c51\n"</span><span style="color:#989899;">"d</span><span style="color:#020204;">ir</span><span style="color:#060608;">/r</span><span style="color:#212122;">oo</span><span style="color:#303030;">t0</span><span style="color:#212121;">70</span><span style="color:#0a0a0a;">00</span><span style="color:#1b1b1b;">0\</span><span style="color:#1f1f1f;">n"</span><span style="color:#252525;">"d</span><span style="color:#161617;">ir</span><span style="color:#0d0d0e;">/s</span><span style="color:#040406;">bi</span><span style="color:#020204;">n07550</span><span style="color:#727272;">0\</span><span style="color:#fefefc;">n""file/sbin/kinit/usr/s
rc/klibc/kinit/kinit075500\n</span><span style="color:#fbfbf9;">",</span><span style="color:#222224;">pr</span><span style="color:#161004;">og</span><span style="color:#614707;">);</span><span style="color:#99730a;">}s</span><span style="color:#9a7409;">tr</span><span style="color:#513d07;">uc</span><span style="color:#050404;">tf</span><span style="color:#050506;">il</span><span style="color:#383839;">e_</span><span style="color:#a4a4a4;">ha</span><span style="color:#fdfdfc;">ndlerfile_handler_table[]={{</span><span style="color:#fcfcfb;">.t</span><span style="color:#e3e3e3;">yp</span><span style="color:#e9e9e9;">e=</span><span style="color:#fbfbfc;">"f</span><span style="color:#fdfdfc;">ile",.handler=cpio_mkfile_line,},{.type="nod",.handler=c</span><span style="color:#6c6c6d;">pi</span><span style="color:#060607;">o_</span><span style="color:#1e1e1e;">mk</span><span style="color:#141415;">no</span><span style="color:#030305;">d_</span><span style="color:#020204;">line</span><span style="color:#030304;">,}</span><span style="color:#030305;">,{</span><span style="color:#0c0c0d;">.t</span><span style="color:#1e1e1e;">yp</span><span style="color:#323232;">e=</span><span style="color:#464647;">"d</span><span style="color:#171718;">ir</span><span style="color:#030305;">",</span><span style="color:#020204;">.h</span><span style="color:#a6a6a5;">an</span><span style="color:#fefefc;">dler=cpio_mkdir_line,},{
.type="slink",.handler=cpio_mk</span><span style="color:#bbaf96;">sl</span><span style="color:#b6830a;">in</span><span style="color:#e8af0e;">k_</span><span style="color:#f5bd10;">li</span><span style="color:#f6bd10;">ne</span><span style="color:#eeb60d;">,}</span><span style="color:#8b6a08;">,{</span><span style="color:#090704;">.t</span><span style="color:#050507;">yp</span><span style="color:#575756;">e=</span><span style="color:#e8e8e8;">"p</span><span style="color:#fdfdfc;">ipe",.handler=cpio_mkpipe_</span><span style="color:#fcfcfb;">li</span><span style="color:#e3e3e3;">ne</span><span style="color:#eaeaea;">,}</span><span style="color:#fbfbfc;">,{</span><span style="color:#fdfdfc;">.type="sock",.handler=cpio_mksock_line,},{.type=</span><span style="color:#fcfcfb;">NU</span><span style="color:#fcfcfa;">LL</span><span style="color:#fdfcfa;">,.</span><span style="color:#f7f7f5;">ha</span><span style="color:#2c2b2c;">nd</span><span style="color:#1c1c1d;">le</span><span style="color:#080809;">r=</span><span style="color:#020204;">NULL,}};#defineL</span><span style="color:#060607;">IN</span><span style="color:#434343;">E_</span><span style="color:#5c5c5c;">SI</span><span style="color:#171718;">ZE</span><span style="color:#020204;">(2</span><span style="color:#d7d7d5;">*P</span><span style="color:#fefefc;">ATH_MAX+50)intmain(intar
gc,char*argv[]){FILE*cpio_li</span><span style="color:#fbfaf4;">st</span><span style="color:#c99a33;">;c</span><span style="color:#dfa50c;">ha</span><span style="color:#f0b70d;">rl</span><span style="color:#f6bc10;">in</span><span style="color:#f6bd10;">e[LI</span><span style="color:#f0b90c;">NE</span><span style="color:#947008;">_S</span><span style="color:#0a0804;">IZ</span><span style="color:#0b0b0c;">E]</span><span style="color:#555555;">;c</span><span style="color:#e0e0e0;">ha</span><span style="color:#fdfdfc;">r*args,*type;intec=0;int</span><span style="color:#fbfbfb;">li</span><span style="color:#e2e2e2;">ne</span><span style="color:#ebebeb;">_n</span><span style="color:#fbfbfc;">r=</span><span style="color:#fdfdfc;">0;if(2!=argc){usage(argv[0]);exit(1);}if(!(cpi</span><span style="color:#f6eacb;">o_</span><span style="color:#e8bd4b;">li</span><span style="color:#edbf3f;">st</span><span style="color:#ecbe41;">=f</span><span style="color:#e9bb40;">op</span><span style="color:#89650b;">en</span><span style="color:#252117;">(a</span><span style="color:#020204;">rgv[1],"r"))){fpri</span><span style="color:#070708;">nt</span><span style="color:#2f2f2f;">f(</span><span style="color:#363635;">st</span><span style="color:#1b1a1b;">de</span><span style="color:#1f1f20;">rr</span><span style="color:#fcfcfb;">,"</span><span style="color:#fefefc;">ERROR:unabletoopen'%s':%
s\n\n",argv[1],strerror(errn</span><span style="color:#dec289;">o)</span><span style="color:#ce920c;">);</span><span style="color:#e5ab0b;">us</span><span style="color:#f1b80d;">ag</span><span style="color:#f5bc0f;">e(</span><span style="color:#f6bd10;">argv</span><span style="color:#f6bd0f;">[0</span><span style="color:#f1ba0c;">])</span><span style="color:#967108;">;e</span><span style="color:#080604;">xi</span><span style="color:#060607;">t(</span><span style="color:#454545;">1)</span><span style="color:#d9d9d8;">;}</span><span style="color:#fdfdfc;">while(fgets(line,LINE_</span><span style="color:#fbfbfb;">SI</span><span style="color:#e2e2e2;">ZE</span><span style="color:#ececeb;">,c</span><span style="color:#fcfcfc;">pi</span><span style="color:#fdfdfc;">o_list)){inttype_idx;size_tslen=strlen(line)</span><span style="color:#fcfcfb;">;l</span><span style="color:#e8b83f;">in</span><span style="color:#f1bf0f;">e_</span><span style="color:#f5d40d;">nr</span><span style="color:#f5d50d;">++</span><span style="color:#f4d10d;">;i</span><span style="color:#eebf0f;">f(</span><span style="color:#261d0b;">'#</span><span style="color:#020204;">'==*line){/*commen</span><span style="color:#0f0f0f;">t-</span><span style="color:#2c2c2c;">sk</span><span style="color:#1c1c1c;">ip</span><span style="color:#29200a;">to</span><span style="color:#b99c40;">ne</span><span style="color:#fbf6e2;">xt</span><span style="color:#fefefc;">line*/continue;}if(!(typ
e=strtok(line,"\t"))){fpri</span><span style="color:#f8f3e7;">nt</span><span style="color:#c78d19;">f(</span><span style="color:#d79a0c;">st</span><span style="color:#e8ad0c;">de</span><span style="color:#efb60d;">rr</span><span style="color:#f4bb0f;">,"</span><span style="color:#f6bd10;">ERROR:</span><span style="color:#f6bd0e;">in</span><span style="color:#edb80c;">co</span><span style="color:#7c5d07;">rr</span><span style="color:#040304;">ec</span><span style="color:#08080a;">tf</span><span style="color:#373637;">or</span><span style="color:#c6c6c6;">ma</span><span style="color:#fcfcfb;">t,</span><span style="color:#fdfdfc;">couldnotlocatefile</span><span style="color:#fbfbfb;">ty</span><span style="color:#e2e2e2;">pe</span><span style="color:#e8e8e8;">li</span><span style="color:#fcfcfb;">ne</span><span style="color:#fdfdfc;">%d:'%s'\n",line_nr,line);ec=-1;break;}if('\n</span><span style="color:#fbfbfa;">'=</span><span style="color:#dca422;">=*</span><span style="color:#ecb40c;">ty</span><span style="color:#f3c00c;">pe</span><span style="color:#f3ce0c;">){</span><span style="color:#f2cf0c;">/*</span><span style="color:#d6b10e;">ab</span><span style="color:#171209;">la</span><span style="color:#020204;">nkline*/continue</span><span style="color:#030305;">;}</span><span style="color:#181819;">if</span><span style="color:#111112;">(s</span><span style="color:#090808;">le</span><span style="color:#826309;">n=</span><span style="color:#f0c70c;">=s</span><span style="color:#f1d21d;">tr</span><span style="color:#fbf6df;">le</span><span style="color:#fefefc;">n(type)){/*mustbeanemp
tyline*/continue;}if(!(a</span><span style="color:#f9f6ed;">rg</span><span style="color:#d2a854;">s=</span><span style="color:#ce910c;">st</span><span style="color:#dfa40c;">rt</span><span style="color:#ebb10c;">ok</span><span style="color:#f2ba0f;">(N</span><span style="color:#f5bc10;">UL</span><span style="color:#f6bd10;">L,"\n"))</span><span style="color:#f5be0d;">){</span><span style="color:#e1b00b;">fp</span><span style="color:#4b3806;">ri</span><span style="color:#020204;">nt</span><span style="color:#050506;">f(</span><span style="color:#242424;">st</span><span style="color:#a1a1a1;">de</span><span style="color:#f7f7f7;">rr</span><span style="color:#fdfdfc;">,"ERROR:incorrec</span><span style="color:#fcfcfb;">tf</span><span style="color:#e9e9e9;">or</span><span style="color:#e4e4e4;">ma</span><span style="color:#f8f8f8;">t,</span><span style="color:#fdfdfc;">newlinerequiredline%d:'%s'\n",line_nr,line);</span><span style="color:#fcfcfb;">ec</span><span style="color:#dca527;">=-</span><span style="color:#e9af0e;">1;</span><span style="color:#f4bc0e;">}f</span><span style="color:#f3bf0c;">or</span><span style="color:#edc30c;">(t</span><span style="color:#b78d0c;">yp</span><span style="color:#151007;">e_</span><span style="color:#020204;">idx=0;file_handler</span><span style="color:#030305;">_t</span><span style="color:#030304;">ab</span><span style="color:#372a08;">le</span><span style="color:#dbb40b;">[t</span><span style="color:#f1ca0b;">yp</span><span style="color:#f3d10c;">e_</span><span style="color:#efd870;">id</span><span style="color:#fefefc;">x].type;type_idx++){in
trc;if(!st</span><span style="color:#f4eddd;">rc</span><span style="color:#dfc896;">mp</span><span style="color:#d8b976;">(l</span><span style="color:#d7b66e;">in</span><span style="color:#d7b772;">e,</span><span style="color:#d5b877;">fi</span><span style="color:#cdab5e;">le</span><span style="color:#bf8d1e;">_h</span><span style="color:#c98f0d;">an</span><span style="color:#d99e0d;">dl</span><span style="color:#e6ab0b;">er</span><span style="color:#efb60e;">_t</span><span style="color:#f5bc10;">ab</span><span style="color:#f5bc0f;">le</span><span style="color:#f6bd10;">[type_id</span><span style="color:#f6bd0e;">x]</span><span style="color:#f4bf0d;">.t</span><span style="color:#ca9b0b;">yp</span><span style="color:#221905;">e)</span><span style="color:#020204;">){</span><span style="color:#030305;">if</span><span style="color:#101010;">((</span><span style="color:#777777;">rc</span><span style="color:#f2f2f1;">=f</span><span style="color:#fdfdfc;">ile_handler_tabl</span><span style="color:#fafafa;">e[</span><span style="color:#f5f5f5;">ty</span><span style="color:#fafafb;">pe</span><span style="color:#fdfdfc;">_idx].handler(args))){ec=rc;fprintf(stderr,"</span><span style="color:#fbfbfa;">li</span><span style="color:#dda935;">ne</span><span style="color:#e9af0e;">%d</span><span style="color:#f4bc0e;">\n</span><span style="color:#f0bc0c;">",</span><span style="color:#e6b50b;">li</span><span style="color:#b8840b;">ne</span><span style="color:#1e1504;">_n</span><span style="color:#020204;">r);}break;}}if(NUL</span><span style="color:#030304;">L=</span><span style="color:#0f0b04;">=f</span><span style="color:#b28509;">il</span><span style="color:#edc30b;">e_</span><span style="color:#eebe0b;">ha</span><span style="color:#f2c30b;">nd</span><span style="color:#e9c33e;">le</span><span style="color:#fefefc;">r_table[type_idx].type
){fprint</span><span style="color:#e4d0a7;">f(</span><span style="color:#c18a14;">st</span><span style="color:#cd920b;">de</span><span style="color:#d79c0b;">rr</span><span style="color:#d89d0b;">,"</span><span style="color:#d4990b;">un</span><span style="color:#cd930b;">kn</span><span style="color:#cb920b;">ow</span><span style="color:#d59b0c;">nf</span><span style="color:#dca20c;">il</span><span style="color:#e6ab0c;">et</span><span style="color:#eeb40e;">yp</span><span style="color:#f4bb10;">el</span><span style="color:#f6bd10;">ine%d:'%s'\n</span><span style="color:#f5bc0f;">",</span><span style="color:#f5bd0c;">li</span><span style="color:#eec20c;">ne</span><span style="color:#9b750a;">_n</span><span style="color:#060504;">r,</span><span style="color:#020204;">line</span><span style="color:#0a0a0a;">);</span><span style="color:#4d4d4c;">}}</span><span style="color:#dadada;">if</span><span style="color:#fdfdfc;">(ec==0)cpio_trailer();exit(ec);}#includestdio.h#includestdli</span><span style="color:#fbfbfb;">b.</span><span style="color:#ececec;">h#</span><span style="color:#dddbd8;">in</span><span style="color:#d9a636;">cl</span><span style="color:#e8ad0d;">ud</span><span style="color:#f2ba0d;">es</span><span style="color:#ecb70b;">ys</span><span style="color:#e2aa0a;">/t</span><span style="color:#c58c0a;">yp</span><span style="color:#493105;">es</span><span style="color:#080504;">.h</span><span style="color:#020204;">#includesys/st</span><span style="color:#030204;">at</span><span style="color:#090604;">.h</span><span style="color:#7f5908;">#i</span><span style="color:#dfae0a;">nc</span><span style="color:#e8bc0b;">lu</span><span style="color:#edb80b;">de</span><span style="color:#f1bb0c;">st</span><span style="color:#eabc3a;">ri</span><span style="color:#fefefc;">ng.h#includeunistd.h#i
nclude</span><span style="color:#f0e7d3;">ti</span><span style="color:#c18915;">me</span><span style="color:#d4980c;">.h</span><span style="color:#dea30c;">#i</span><span style="color:#e5aa0c;">nc</span><span style="color:#e6ac0c;">lu</span><span style="color:#e3a90b;">de</span><span style="color:#e2a80b;">fc</span><span style="color:#e1a80b;">nt</span><span style="color:#e7ae0c;">l.</span><span style="color:#ecb30e;">h#</span><span style="color:#efb60e;">in</span><span style="color:#f5bc10;">cl</span><span style="color:#f6bd10;">ud</span><span style="color:#f5bc10;">ee</span><span style="color:#f6bd10;">rrno.h#inc</span><span style="color:#f5bc0f;">lu</span><span style="color:#f3bb0c;">de</span><span style="color:#f3c40c;">ct</span><span style="color:#dfb50c;">yp</span><span style="color:#5d4507;">e.</span><span style="color:#020204;">h#in</span><span style="color:#030304;">cl</span><span style="color:#020204;">ud</span><span style="color:#323232;">el</span><span style="color:#c6c6c5;">im</span><span style="color:#fbfbfb;">it</span><span style="color:#fdfdfc;">s.h/**OriginalworkbyJeffGarzik**Externalfilelists,symlin</span><span style="color:#e6e6e6;">k,</span><span style="color:#c7c7c7;">pi</span><span style="color:#c4c4c3;">pe</span><span style="color:#d7a432;">an</span><span style="color:#e7ad0d;">df</span><span style="color:#efb70c;">if</span><span style="color:#eab20b;">os</span><span style="color:#dfa409;">up</span><span style="color:#c68b07;">po</span><span style="color:#986806;">rt</span><span style="color:#291c04;">by</span><span style="color:#0a0604;">Th</span><span style="color:#020204;">ayneHarbau</span><span style="color:#040304;">gh</span><span style="color:#1c1304;">*H</span><span style="color:#7e5806;">ar</span><span style="color:#d29708;">dl</span><span style="color:#e2af09;">in</span><span style="color:#e9b60a;">ks</span><span style="color:#edb60b;">up</span><span style="color:#f1b70c;">po</span><span style="color:#e5b231;">rt</span><span style="color:#fefefc;">byLucianoRocha*/#defin
exstr(</span><span style="color:#d7bf8d;">s)</span><span style="color:#c68c0d;">#s</span><span style="color:#dea30c;">#d</span><span style="color:#e9b00c;">ef</span><span style="color:#eeb50d;">in</span><span style="color:#efb50d;">es</span><span style="color:#eeb50e;">tr</span><span style="color:#ecb20d;">(s</span><span style="color:#edb40e;">)x</span><span style="color:#f1b80e;">st</span><span style="color:#f3bb0f;">r(</span><span style="color:#f5bc10;">s)</span><span style="color:#f6bd10;">st</span><span style="color:#f5bd10;">at</span><span style="color:#f6bd10;">ic</span><span style="color:#f6bd11;">un</span><span style="color:#f6bd10;">signedin</span><span style="color:#f5bc0f;">to</span><span style="color:#f3bb0d;">ff</span><span style="color:#f2bd0c;">se</span><span style="color:#edc50c;">t;</span><span style="color:#c2950b;">st</span><span style="color:#181105;">at</span><span style="color:#020204;">icunsi</span><span style="color:#030304;">gn</span><span style="color:#1b1b1b;">ed</span><span style="color:#999998;">in</span><span style="color:#f9f9f8;">ti</span><span style="color:#fdfdfc;">no=721;structfile_handler{constchar*type;int(*handle</span><span style="color:#f9f9f8;">r)</span><span style="color:#cdcdcd;">(c</span><span style="color:#c4c4c4;">on</span><span style="color:#c4c3c2;">st</span><span style="color:#d7a22c;">ch</span><span style="color:#e4a90c;">ar</span><span style="color:#ecb30b;">*l</span><span style="color:#e8af0b;">in</span><span style="color:#dfa408;">e)</span><span style="color:#cc9107;">;}</span><span style="color:#b57e06;">;s</span><span style="color:#9d6c06;">ta</span><span style="color:#4e3605;">ti</span><span style="color:#261a04;">cv</span><span style="color:#1a1204;">oi</span><span style="color:#150e04;">dp</span><span style="color:#1c1304;">us</span><span style="color:#3a2905;">h_</span><span style="color:#6e4d06;">st</span><span style="color:#a67406;">ri</span><span style="color:#c78d07;">ng</span><span style="color:#dda308;">(c</span><span style="color:#e7b00a;">on</span><span style="color:#eeb70b;">st</span><span style="color:#f2b90c;">ch</span><span style="color:#f3b90c;">ar</span><span style="color:#e6ae16;">*n</span><span style="color:#f9f7f1;">am</span><span style="color:#fefefc;">e){unsignedintname_l
en=str</span><span style="color:#d9bf89;">le</span><span style="color:#cb920d;">n(</span><span style="color:#e1a80c;">na</span><span style="color:#ecb40c;">me</span><span style="color:#f1b80c;">)+</span><span style="color:#f3ba0d;">1;</span><span style="color:#f4bb0f;">fp</span><span style="color:#f3ba0e;">ut</span><span style="color:#f4bb0f;">s(</span><span style="color:#f5bc0f;">na</span><span style="color:#f5bd10;">me</span><span style="color:#f6bd10;">,s</span><span style="color:#f5bc10;">td</span><span style="color:#f5bc0f;">out)</span><span style="color:#f6bd10;">;putchar(0);</span><span style="color:#f4bb0e;">of</span><span style="color:#f3bb0c;">fs</span><span style="color:#f1c30c;">et</span><span style="color:#e4bc0b;">+=</span><span style="color:#7d5c08;">na</span><span style="color:#020204;">me_len;}st</span><span style="color:#0c0c0d;">at</span><span style="color:#6c6c6c;">ic</span><span style="color:#f2f2f1;">vo</span><span style="color:#fdfdfc;">idpush_pad(void){while(offset3){putchar(0);offset+</span><span style="color:#f5f5f4;">+;</span><span style="color:#c9c9c9;">}}</span><span style="color:#c4c4c4;">st</span><span style="color:#c4c3c3;">at</span><span style="color:#d29e30;">ic</span><span style="color:#dfa40b;">vo</span><span style="color:#eab00b;">id</span><span style="color:#e8af0b;">pu</span><span style="color:#e2a808;">sh</span><span style="color:#d59908;">_r</span><span style="color:#c48906;">es</span><span style="color:#ba8105;">t(</span><span style="color:#b37c05;">co</span><span style="color:#ad7807;">ns</span><span style="color:#a47106;">tcha</span><span style="color:#aa7607;">r*</span><span style="color:#b07b09;">na</span><span style="color:#b78108;">me</span><span style="color:#c68d08;">){</span><span style="color:#dba109;">un</span><span style="color:#e9af0b;">si</span><span style="color:#efb60c;">gn</span><span style="color:#f2b90c;">ed</span><span style="color:#f4bc0e;">in</span><span style="color:#f4bb0e;">tn</span><span style="color:#f1b80f;">am</span><span style="color:#e9d397;">e_</span><span style="color:#fefefc;">len=strlen(name)+1;u
nsigne</span><span style="color:#d7bc86;">di</span><span style="color:#cb920c;">nt</span><span style="color:#e2a90c;">tm</span><span style="color:#edb40c;">p_</span><span style="color:#f2b90d;">of</span><span style="color:#f5bc10;">s;</span><span style="color:#f6bd10;">fp</span><span style="color:#f5bc10;">ut</span><span style="color:#f5bd10;">s(</span><span style="color:#f5bc10;">na</span><span style="color:#f5bd10;">me</span><span style="color:#f6bd10;">,s</span><span style="color:#f5bc0f;">td</span><span style="color:#f5bc10;">ou</span><span style="color:#f6bd10;">t);putchar(0);</span><span style="color:#f5bc0f;">of</span><span style="color:#f4bb0c;">fs</span><span style="color:#f2bd0c;">et</span><span style="color:#efc90c;">+=</span><span style="color:#d1a30b;">na</span><span style="color:#2a1e05;">me</span><span style="color:#020204;">_len</span><span style="color:#030304;">;t</span><span style="color:#020204;">mp_o</span><span style="color:#050506;">fs</span><span style="color:#555556;">=n</span><span style="color:#f1f1f1;">am</span><span style="color:#fdfdfc;">e_len+110;while(tmp_ofs3){putchar(0);offset++;tm</span><span style="color:#f3f3f3;">p_</span><span style="color:#cacaca;">of</span><span style="color:#c4c4c4;">s+</span><span style="color:#c4c3c2;">+;</span><span style="color:#ca982d;">}}</span><span style="color:#da9f09;">st</span><span style="color:#e9b00b;">at</span><span style="color:#eab00b;">ic</span><span style="color:#e5ab09;">vo</span><span style="color:#dba007;">id</span><span style="color:#d09408;">pu</span><span style="color:#c98d08;">sh</span><span style="color:#c58907;">_h</span><span style="color:#c28608;">dr</span><span style="color:#c08509;">(c</span><span style="color:#bf8509;">on</span><span style="color:#c38808;">st</span><span style="color:#c78c08;">ch</span><span style="color:#cf9508;">ar</span><span style="color:#dba109;">*s</span><span style="color:#eab10b;">){</span><span style="color:#f2b90c;">fp</span><span style="color:#f4bb0e;">ut</span><span style="color:#f5bc0e;">s(</span><span style="color:#f6bd10;">s,</span><span style="color:#f5bc10;">st</span><span style="color:#f1b910;">do</span><span style="color:#e4af1a;">ut</span><span style="color:#f8f1dc;">);</span><span style="color:#fefefc;">offset+=110;}stati
cvoidc</span><span style="color:#ddc89c;">pi</span><span style="color:#c78f0e;">o_</span><span style="color:#dfa60c;">tr</span><span style="color:#ecb20c;">ai</span><span style="color:#f2b90d;">le</span><span style="color:#f6bd10;">r(void){chars[256];constcharname[]</span><span style="color:#f4bc0e;">="</span><span style="color:#f3bb0c;">TR</span><span style="color:#f1c10c;">AI</span><span style="color:#ebc40c;">LE</span><span style="color:#9c7409;">R!</span><span style="color:#060504;">!!</span><span style="color:#020204;">";sprintf(</span><span style="color:#060607;">s,</span><span style="color:#717171;">"%</span><span style="color:#fafaf9;">s%</span><span style="color:#fdfdfc;">08X%08X%08lX%08lX%08X%08lX""%08X%08X%08X%08X%0</span><span style="color:#f3f3f3;">8X</span><span style="color:#cdcdcd;">%0</span><span style="color:#c4c4c5;">8X</span><span style="color:#c3c2c2;">%0</span><span style="color:#c1922c;">8X</span><span style="color:#d29709;">",</span><span style="color:#e5ab09;">"0</span><span style="color:#eab10b;">70</span><span style="color:#e8af0b;">70</span><span style="color:#e2a809;">1"</span><span style="color:#d99e07;">,/</span><span style="color:#d59908;">*m</span><span style="color:#d29508;">ag</span><span style="color:#cf9309;">ic</span><span style="color:#cd9208;">*/</span><span style="color:#ce9308;">0,</span><span style="color:#d09508;">/*</span><span style="color:#d49a08;">in</span><span style="color:#dda308;">o*</span><span style="color:#e7ad0a;">/0</span><span style="color:#f2b90e;">,/</span><span style="color:#f6bd10;">*mode*/(</span><span style="color:#f5bc10;">lo</span><span style="color:#f2b910;">ng</span><span style="color:#eeb610;">)0</span><span style="color:#e4b941;">,/</span><span style="color:#fcfaf4;">*u</span><span style="color:#fefefc;">id*/(long)0,/*gi
d*/1,/</span><span style="color:#e4d2ae;">*n</span><span style="color:#c58c0d;">li</span><span style="color:#dca10c;">nk</span><span style="color:#e9af0c;">*/</span><span style="color:#f1b80d;">(l</span><span style="color:#f5bc0f;">on</span><span style="color:#f6bd10;">g)0,/*mtime*/0,/*filesize*/0,/*maj</span><span style="color:#f4bc0d;">or</span><span style="color:#f3bd0c;">*/</span><span style="color:#f0c70c;">0,</span><span style="color:#dcae0b;">/*</span><span style="color:#553e07;">mi</span><span style="color:#020204;">nor*/0,/*rma</span><span style="color:#171718;">jo</span><span style="color:#d0d0d1;">r*</span><span style="color:#fdfdfc;">/0,/*rminor*/(unsigned)strlen(name)+1,/*namesi</span><span style="color:#f7f7f6;">ze</span><span style="color:#d5d5d5;">*/</span><span style="color:#c4c4c4;">0)</span><span style="color:#c3c2c1;">;/</span><span style="color:#b88c27;">*c</span><span style="color:#cc9209;">hk</span><span style="color:#e0a708;">su</span><span style="color:#e9b00b;">m*</span><span style="color:#ebb20b;">/p</span><span style="color:#e8ae0b;">us</span><span style="color:#e3a808;">h_</span><span style="color:#dfa309;">hd</span><span style="color:#dba009;">r(</span><span style="color:#d99e08;">s)</span><span style="color:#d89d08;">;p</span><span style="color:#d99f08;">us</span><span style="color:#dba108;">h_</span><span style="color:#e0a609;">re</span><span style="color:#e6ad0a;">st</span><span style="color:#edb40b;">(n</span><span style="color:#f4bb0e;">am</span><span style="color:#f6bd10;">e);while</span><span style="color:#f5bc11;">(o</span><span style="color:#f3ba10;">ff</span><span style="color:#f1b811;">se</span><span style="color:#ecb310;">t%</span><span style="color:#ddba5e;">51</span><span style="color:#faf8f3;">2)</span><span style="color:#fefefc;">{putchar(0);of
fset++</span><span style="color:#ecdfc5;">;}</span><span style="color:#c58b0e;">}s</span><span style="color:#d99e0d;">ta</span><span style="color:#e6ad0c;">ti</span><span style="color:#efb60c;">ci</span><span style="color:#f4bb0f;">nt</span><span style="color:#f6bd10;">cpio_mkslink(constchar*name,constc</span><span style="color:#f5bc0f;">ha</span><span style="color:#f4bb0c;">r*</span><span style="color:#f2be0c;">ta</span><span style="color:#ecc50c;">rg</span><span style="color:#c5940b;">et</span><span style="color:#191205;">,u</span><span style="color:#020204;">nsignedint</span><span style="color:#030305;">mo</span><span style="color:#a7a7a7;">de</span><span style="color:#fdfdfc;">,uid_tuid,gid_tgid){chars[256];time_tmtime=tim</span><span style="color:#fafafa;">e(</span><span style="color:#e0e0df;">NU</span><span style="color:#c5c5c5;">LL</span><span style="color:#b9b8b6;">);</span><span style="color:#af8421;">sp</span><span style="color:#ca9009;">ri</span><span style="color:#dda408;">nt</span><span style="color:#e9b00b;">f(</span><span style="color:#efb50c;">s,</span><span style="color:#eeb40b;">"%</span><span style="color:#ebb10b;">s%</span><span style="color:#e6ad0a;">08</span><span style="color:#e3aa09;">X%</span><span style="color:#e1a809;">08</span><span style="color:#e1a709;">X%</span><span style="color:#e2a909;">08</span><span style="color:#e4ab0a;">lX</span><span style="color:#e8af0a;">%0</span><span style="color:#ecb30b;">8l</span><span style="color:#f0b70c;">X%</span><span style="color:#f5bc0f;">08</span><span style="color:#f6bd10;">X%08lX""%0</span><span style="color:#f5bc10;">8X</span><span style="color:#f3ba10;">%0</span><span style="color:#f0b711;">8X</span><span style="color:#e9b10f;">%0</span><span style="color:#e1bb52;">8X</span><span style="color:#f9f5ea;">%0</span><span style="color:#fefefc;">8X%08X%08X%0
8X","0</span><span style="color:#f7f2e7;">70</span><span style="color:#c48c17;">70</span><span style="color:#d69a0c;">1"</span><span style="color:#e5aa0c;">,/</span><span style="color:#efb60c;">*m</span><span style="color:#f4bb0f;">ag</span><span style="color:#f6bd10;">ic*/ino++,/*ino*/S_IFLNK|mode,/*mode</span><span style="color:#f5bc0d;">*/</span><span style="color:#f3bc0c;">(l</span><span style="color:#f0c50c;">on</span><span style="color:#e4ba0b;">g)</span><span style="color:#856109;">ui</span><span style="color:#030304;">d,</span><span style="color:#020204;">/*uid*/(</span><span style="color:#030305;">lo</span><span style="color:#a1a1a1;">ng</span><span style="color:#fdfdfc;">)gid,/*gid*/1,/*nlink*/(long)mtime,/*mtime*/(u</span><span style="color:#fbfbfa;">ns</span><span style="color:#e3e3e3;">ig</span><span style="color:#c5c5c5;">ne</span><span style="color:#5d5b57;">d)</span><span style="color:#a3740b;">st</span><span style="color:#cb9008;">rl</span><span style="color:#dda307;">en</span><span style="color:#e9b00b;">(t</span><span style="color:#f0b70c;">ar</span><span style="color:#f1b80c;">ge</span><span style="color:#f0b70c;">t)</span><span style="color:#edb40b;">+1</span><span style="color:#eab10b;">,/</span><span style="color:#e8af0b;">*fil</span><span style="color:#e9af0b;">es</span><span style="color:#ebb20b;">iz</span><span style="color:#edb40b;">e*</span><span style="color:#efb60c;">/3</span><span style="color:#f2b80c;">,/</span><span style="color:#f5bc0f;">*m</span><span style="color:#f6bd10;">ajor*/1,/*mi</span><span style="color:#f5bc10;">no</span><span style="color:#f3ba10;">r*</span><span style="color:#f1b811;">/0</span><span style="color:#efb711;">,/</span><span style="color:#e3b73b;">*r</span><span style="color:#f4ead0;">ma</span><span style="color:#fefefc;">jor*/0,/*r
minor*</span><span style="color:#fbf9f2;">/(</span><span style="color:#c28c1c;">un</span><span style="color:#d4970c;">si</span><span style="color:#e4aa0b;">gn</span><span style="color:#efb60d;">ed</span><span style="color:#f4bb0e;">)s</span><span style="color:#f6bd10;">trlen(name)+1,/*namesize*/0);/*chk</span><span style="color:#f5bc0f;">sum*</span><span style="color:#f4bb0c;">/p</span><span style="color:#f1be0c;">us</span><span style="color:#eec90c;">h_</span><span style="color:#daaa0b;">hd</span><span style="color:#4c3706;">r(</span><span style="color:#020204;">s);push_</span><span style="color:#1d1d1e;">st</span><span style="color:#dedede;">ri</span><span style="color:#fdfdfc;">ng(name);push_pad();push_string(target);push_p</span><span style="color:#fbfbfb;">ad</span><span style="color:#dfdfdf;">()</span><span style="color:#757474;">;r</span><span style="color:#231a0a;">et</span><span style="color:#a37107;">ur</span><span style="color:#cc9107;">n0</span><span style="color:#dda407;">;}</span><span style="color:#e9b00b;">st</span><span style="color:#f0b80c;">at</span><span style="color:#f2b90d;">ic</span><span style="color:#f3ba0e;">in</span><span style="color:#f2ba0e;">tc</span><span style="color:#f1b80e;">pi</span><span style="color:#f0b80e;">o_</span><span style="color:#f0b70e;">mksl</span><span style="color:#f2b90e;">ink_</span><span style="color:#f3ba0d;">li</span><span style="color:#f4bb0e;">ne</span><span style="color:#f6bd10;">(constchar*line)</span><span style="color:#f5bc10;">{c</span><span style="color:#f4bb10;">ha</span><span style="color:#f3bb10;">rn</span><span style="color:#f3ba10;">am</span><span style="color:#edb81c;">e[</span><span style="color:#e8cc82;">PA</span><span style="color:#f4f1e7;">TH</span><span style="color:#fefefc;">_MAX+1
];char</span><span style="color:#fcfbf6;">ta</span><span style="color:#c58d1c;">rg</span><span style="color:#d2950b;">et</span><span style="color:#e2a70c;">[P</span><span style="color:#efb60d;">AT</span><span style="color:#f4bb0f;">H_</span><span style="color:#f6bd10;">MAX+1];unsignedintmode;intuid;intg</span><span style="color:#f5bc0f;">id;i</span><span style="color:#f5bc0e;">nt</span><span style="color:#f2bb0c;">rc</span><span style="color:#efc10b;">=-</span><span style="color:#ecc80d;">1;</span><span style="color:#b8880a;">if</span><span style="color:#130d04;">(5</span><span style="color:#040405;">!=</span><span style="color:#0a0a0c;">ss</span><span style="color:#4c4c4d;">ca</span><span style="color:#cecece;">nf</span><span style="color:#fdfdfc;">(line,"%"str(PATH_MAX)"s%"str(PATH_MAX)"s%o%d%d"</span><span style="color:#f5f5f5;">,n</span><span style="color:#6b6b6c;">am</span><span style="color:#0a0a0b;">e,</span><span style="color:#231804;">ta</span><span style="color:#a07007;">rg</span><span style="color:#cc9207;">et</span><span style="color:#dda407;">,m</span><span style="color:#eab10b;">od</span><span style="color:#f1b80c;">e,</span><span style="color:#f3ba0e;">ui</span><span style="color:#f5bc0f;">d,</span><span style="color:#f6bd10;">gid)){fprintf(stderr,"Unrecognizeddirfor</span><span style="color:#f5bc10;">mat'</span><span style="color:#f2b910;">%s</span><span style="color:#e3b024;">'"</span><span style="color:#f7efdc;">,l</span><span style="color:#fefefc;">ine)
;gotof</span><span style="color:#fbf9f4;">ai</span><span style="color:#c48a12;">l;</span><span style="color:#d2950a;">}r</span><span style="color:#e1a70b;">c=</span><span style="color:#f0b70d;">cp</span><span style="color:#f3ba0f;">io</span><span style="color:#f5bc0f;">_mks</span><span style="color:#f6bd10;">link</span><span style="color:#f6bc0f;">(n</span><span style="color:#f6bd10;">ame,target,mode,uid,gid);fai</span><span style="color:#f6bd0f;">l:</span><span style="color:#f3bb0c;">re</span><span style="color:#efbc0b;">tu</span><span style="color:#edc60c;">rn</span><span style="color:#e2b90c;">rc</span><span style="color:#8f660b;">;}</span><span style="color:#979591;">st</span><span style="color:#dbdbda;">at</span><span style="color:#fcfcfb;">ic</span><span style="color:#fdfdfc;">intcpio_mkgeneric(constchar*name,unsignedintmode</span><span style="color:#eeeeee;">,u</span><span style="color:#5e5e5f;">id</span><span style="color:#030305;">_t</span><span style="color:#020204;">ui</span><span style="color:#332304;">d,</span><span style="color:#a07007;">gi</span><span style="color:#cb9207;">d_</span><span style="color:#dfa508;">tg</span><span style="color:#eab10b;">id</span><span style="color:#f1b80c;">){</span><span style="color:#f4bb0e;">ch</span><span style="color:#f5bd0f;">ar</span><span style="color:#f6bd10;">s[256];time_tmtime=time(NULL);sprintf(s,"%</span><span style="color:#f5bc10;">s%</span><span style="color:#f3ba10;">08</span><span style="color:#ebb10d;">X%</span><span style="color:#efd798;">08</span><span style="color:#fefefc;">X%08
lX%08l</span><span style="color:#f8f4ea;">X%</span><span style="color:#c5890e;">08</span><span style="color:#d2950a;">X%</span><span style="color:#e2a80b;">08</span><span style="color:#f0b70e;">lX</span><span style="color:#f2b90f;">""</span><span style="color:#f4bc0f;">%0</span><span style="color:#f5bc0f;">8X</span><span style="color:#f6bd10;">%0</span><span style="color:#f5bc0f;">8X%08X%0</span><span style="color:#f6bd10;">8X%0</span><span style="color:#f6bd11;">8X</span><span style="color:#f6bd10;">%08X%08X","070701"</span><span style="color:#f5bc10;">,/</span><span style="color:#f4bb0d;">*m</span><span style="color:#f1bb0c;">ag</span><span style="color:#ecbd0b;">ic</span><span style="color:#e9c20b;">*/</span><span style="color:#d29f0b;">in</span><span style="color:#a18955;">o+</span><span style="color:#fcfcfb;">+,</span><span style="color:#fdfdfc;">/*ino*/mode,/*mode*/(long)uid,/*uid*/(long)gid,/</span><span style="color:#d6d6d5;">*g</span><span style="color:#383839;">id</span><span style="color:#020204;">*/2,</span><span style="color:#030204;">/*</span><span style="color:#402c04;">nl</span><span style="color:#a17008;">in</span><span style="color:#ca9207;">k*</span><span style="color:#e0a608;">/(</span><span style="color:#ebb20b;">lo</span><span style="color:#f1b80d;">ng</span><span style="color:#f5bb0f;">)m</span><span style="color:#f6bd10;">time,/*mtime*/0,/*filesize*/3,/*major*/1,/</span><span style="color:#f4bb10;">*m</span><span style="color:#f3ba11;">in</span><span style="color:#f1b710;">or</span><span style="color:#e7ac0d;">*/</span><span style="color:#eed8a0;">0,</span><span style="color:#fefefc;">/*rm
ajor*/</span><span style="color:#eadbbb;">0,</span><span style="color:#c4860a;">/*</span><span style="color:#d2940a;">rm</span><span style="color:#e4aa0a;">in</span><span style="color:#f0b70d;">or</span><span style="color:#f1b90e;">*/</span><span style="color:#f4bb0f;">(u</span><span style="color:#f5bc0f;">ns</span><span style="color:#f6bd10;">igned)</span><span style="color:#f5bc10;">st</span><span style="color:#f5bc0e;">rl</span><span style="color:#f6bd10;">en(name)+1,/*namesize*/0</span><span style="color:#f5bc0f;">);/*</span><span style="color:#f3bb0c;">ch</span><span style="color:#efbb0b;">ks</span><span style="color:#e9c10b;">um</span><span style="color:#e3b90b;">*/</span><span style="color:#bb880b;">pu</span><span style="color:#c0b8a8;">sh</span><span style="color:#fdfdfc;">_hdr(s);push_rest(name);return0;}enumgeneric</span><span style="color:#fbfbfb;">_t</span><span style="color:#adadad;">yp</span><span style="color:#19191a;">es</span><span style="color:#020204;">{GT_DI</span><span style="color:#050304;">R,</span><span style="color:#4e3504;">GT</span><span style="color:#9f6e07;">_P</span><span style="color:#ca9107;">IP</span><span style="color:#e1a808;">E,</span><span style="color:#ecb30b;">GT</span><span style="color:#f2b90d;">_S</span><span style="color:#f5bc0f;">OCK}</span><span style="color:#f6bd10;">;structgeneric_type{constchar*type;mod</span><span style="color:#f4bc10;">e_</span><span style="color:#f2b910;">tm</span><span style="color:#ecb30e;">od</span><span style="color:#e4aa0d;">e;</span><span style="color:#dda51b;">};</span><span style="color:#f9f4e7;">st</span><span style="color:#fefefc;">atic
struct</span><span style="color:#d7b571;">ge</span><span style="color:#c28608;">ne</span><span style="color:#d59909;">ri</span><span style="color:#e8af0b;">c_</span><span style="color:#f1b80d;">ty</span><span style="color:#f3ba0d;">pe</span><span style="color:#f5bc0f;">gene</span><span style="color:#f6bd10;">ric_type_tab</span><span style="color:#f6be11;">le</span><span style="color:#f6bd10;">[]={[GT_DIR]={.type=</span><span style="color:#f6bc10;">"d</span><span style="color:#f5bc0e;">ir</span><span style="color:#f4bb0e;">",</span><span style="color:#f2bb0c;">.m</span><span style="color:#e9bd0b;">od</span><span style="color:#e7c10b;">e=</span><span style="color:#d3a10a;">S_</span><span style="color:#906b1d;">IF</span><span style="color:#e0ddd8;">DI</span><span style="color:#fdfdfc;">R},[GT_PIPE]={.type="pipe",.mode=S_IFI</span><span style="color:#fcfcfc;">FO</span><span style="color:#d9d9d9;">},</span><span style="color:#565657;">[G</span><span style="color:#040406;">T_</span><span style="color:#020204;">SOCK]={.</span><span style="color:#040304;">ty</span><span style="color:#573b05;">pe</span><span style="color:#9a6a07;">="</span><span style="color:#c99006;">so</span><span style="color:#e2a908;">ck</span><span style="color:#ecb30b;">",</span><span style="color:#f2b90d;">.m</span><span style="color:#f4bb0f;">od</span><span style="color:#f5bc10;">e=</span><span style="color:#f6bd10;">S_IFSOCK}};staticintcpio_mkgeneric_l</span><span style="color:#f4bb10;">in</span><span style="color:#f1b810;">e(</span><span style="color:#e9b00d;">co</span><span style="color:#dea20e;">ns</span><span style="color:#d4980f;">tc</span><span style="color:#e8d2a4;">ha</span><span style="color:#fefefc;">r*line
,enu</span><span style="color:#fcfbf7;">mg</span><span style="color:#c18b1e;">en</span><span style="color:#c98d09;">er</span><span style="color:#dfa509;">ic</span><span style="color:#f0b60d;">_t</span><span style="color:#f2b90d;">yp</span><span style="color:#f3bb0e;">es</span><span style="color:#f5bc0f;">gt</span><span style="color:#f6bd10;">){charna</span><span style="color:#f5bc0f;">me</span><span style="color:#f6bd10;">[PATH_MAX+1];unsignedintmo</span><span style="color:#f5bc0f;">de;i</span><span style="color:#f4bb0e;">nt</span><span style="color:#f3ba0d;">ui</span><span style="color:#e9b70a;">d;</span><span style="color:#e5ba0a;">in</span><span style="color:#d8a509;">tg</span><span style="color:#ae7b08;">id</span><span style="color:#685632;">;i</span><span style="color:#e3e3e3;">nt</span><span style="color:#fdfdfc;">rc=-1;if(4!=sscanf(line,"%"str(P</span><span style="color:#fcfcfc;">AT</span><span style="color:#e4e4e3;">H_</span><span style="color:#6c6c6d;">MA</span><span style="color:#0d0d0e;">X)</span><span style="color:#020204;">"s%o%d%d",na</span><span style="color:#0a0704;">me</span><span style="color:#5f4005;">,m</span><span style="color:#9b6907;">od</span><span style="color:#c88f06;">e,</span><span style="color:#e1a808;">ui</span><span style="color:#ebb30b;">d,</span><span style="color:#f2b90d;">gi</span><span style="color:#f4bb0f;">d)</span><span style="color:#f6bd10;">){fprintf(stderr,"Unrecognized%s</span><span style="color:#f5bc10;">form</span><span style="color:#f2b910;">at</span><span style="color:#eeb50e;">'%</span><span style="color:#e6ac0d;">s'</span><span style="color:#da9e0d;">",</span><span style="color:#ce9416;">li</span><span style="color:#e0c896;">ne</span><span style="color:#fefefb;">,g</span><span style="color:#fefefc;">eneric
_typ</span><span style="color:#e1cc9f;">e_</span><span style="color:#c28509;">ta</span><span style="color:#d39709;">bl</span><span style="color:#e9b00b;">e[</span><span style="color:#f2b90d;">gt</span><span style="color:#f3ba0d;">].</span><span style="color:#f4bb0e;">ty</span><span style="color:#f5bc0f;">pe</span><span style="color:#f6bd0f;">);</span><span style="color:#f6bd10;">gotofail;}mode|=generic_type_table[g</span><span style="color:#f5bc0f;">t]</span><span style="color:#f4bb0e;">.m</span><span style="color:#f3bb0e;">od</span><span style="color:#ecb50b;">e;</span><span style="color:#e1af0a;">rc</span><span style="color:#d9a408;">=c</span><span style="color:#ba8407;">pi</span><span style="color:#754f06;">o_</span><span style="color:#322c23;">mk</span><span style="color:#a0a0a0;">ge</span><span style="color:#f4f4f3;">ne</span><span style="color:#fdfdfc;">ric(name,mode,uid,gid)</span><span style="color:#fcfcfb;">;f</span><span style="color:#f3f3f2;">ai</span><span style="color:#c3c3c3;">l:</span><span style="color:#6e6e6e;">re</span><span style="color:#141415;">tu</span><span style="color:#020204;">rnrc;}staticintc</span><span style="color:#120c04;">pi</span><span style="color:#604005;">o_</span><span style="color:#9d6c07;">mk</span><span style="color:#c88f07;">di</span><span style="color:#e0a708;">r_</span><span style="color:#ebb20b;">li</span><span style="color:#f2b90d;">ne</span><span style="color:#f5bc0f;">(c</span><span style="color:#f6bd10;">onstchar*line){returnc</span><span style="color:#f5bc10;">pi</span><span style="color:#f5bc0f;">o_</span><span style="color:#f6bd10;">mkge</span><span style="color:#f4bb0f;">ne</span><span style="color:#f1b80f;">ri</span><span style="color:#ecb30e;">c_</span><span style="color:#e5ac0e;">li</span><span style="color:#dca10d;">ne</span><span style="color:#d2960d;">(l</span><span style="color:#cfa44c;">in</span><span style="color:#eee4d0;">e,</span><span style="color:#fefefc;">GT_DIR);}s
tati</span><span style="color:#cba34f;">ci</span><span style="color:#c88b09;">nt</span><span style="color:#d89c0a;">cp</span><span style="color:#e4aa09;">io</span><span style="color:#eeb50c;">_m</span><span style="color:#f1b90d;">kp</span><span style="color:#f3ba0e;">ip</span><span style="color:#f4bb0f;">e_</span><span style="color:#f4bc0f;">li</span><span style="color:#f5bc0f;">ne(const</span><span style="color:#f6bd10;">char*line){returncpi</span><span style="color:#f5bd10;">o_</span><span style="color:#f5bc0e;">mk</span><span style="color:#f5bc0f;">ge</span><span style="color:#f6bd10;">ne</span><span style="color:#f5bc0f;">ri</span><span style="color:#f4bb0e;">c_</span><span style="color:#f4bc0e;">li</span><span style="color:#eeb60c;">ne</span><span style="color:#e2ab09;">(l</span><span style="color:#d7a007;">in</span><span style="color:#c18907;">e,</span><span style="color:#916106;">GT</span><span style="color:#442d04;">_P</span><span style="color:#050505;">IP</span><span style="color:#262527;">E)</span><span style="color:#6b6b6b;">;}</span><span style="color:#a2a2a2;">st</span><span style="color:#c9c9c8;">at</span><span style="color:#e0e0e0;">ic</span><span style="color:#ebebea;">in</span><span style="color:#e9e9e9;">tc</span><span style="color:#e0e0df;">pi</span><span style="color:#d6d6d6;">o_</span><span style="color:#cccccb;">mk</span><span style="color:#aaaaaa;">so</span><span style="color:#828283;">ck</span><span style="color:#525253;">_l</span><span style="color:#202021;">in</span><span style="color:#050506;">e(</span><span style="color:#020204;">constchar*line){retu</span><span style="color:#1e1404;">rn</span><span style="color:#644305;">cp</span><span style="color:#a37107;">io</span><span style="color:#c78f07;">_m</span><span style="color:#dfa607;">kg</span><span style="color:#ebb20b;">en</span><span style="color:#f2b90d;">er</span><span style="color:#f5bd10;">ic</span><span style="color:#f6bd10;">_line(line,GT_SOCK);</span><span style="color:#f4bb10;">}s</span><span style="color:#f2b910;">ta</span><span style="color:#f3ba10;">ti</span><span style="color:#f4bb0f;">ci</span><span style="color:#f2b90e;">nt</span><span style="color:#ebb20c;">cp</span><span style="color:#e0a60b;">io</span><span style="color:#d79b0b;">_m</span><span style="color:#ce930f;">kn</span><span style="color:#cda044;">od</span><span style="color:#e7d6b5;">(c</span><span style="color:#fdfdfa;">on</span><span style="color:#fefefc;">stchar*name,
un</span><span style="color:#fdfdfb;">si</span><span style="color:#bc8617;">gn</span><span style="color:#c68908;">ed</span><span style="color:#d29609;">in</span><span style="color:#e0a508;">tm</span><span style="color:#e9b00b;">od</span><span style="color:#eeb40c;">e,</span><span style="color:#efb60c;">ui</span><span style="color:#f0b70c;">d_</span><span style="color:#f0b80c;">tu</span><span style="color:#f1b80d;">id</span><span style="color:#f2b90e;">,g</span><span style="color:#f4bb0f;">id</span><span style="color:#f5bc0f;">_tgid,ch</span><span style="color:#f5bd10;">ar</span><span style="color:#f6bd10;">dev_type,uns</span><span style="color:#f5bc10;">ig</span><span style="color:#f5bd10;">ne</span><span style="color:#f5bc0f;">di</span><span style="color:#f6bd10;">nt</span><span style="color:#f5bc0f;">ma</span><span style="color:#f5bd0f;">j,</span><span style="color:#f5bc0f;">un</span><span style="color:#f0b70c;">si</span><span style="color:#e5ad09;">gn</span><span style="color:#d89f06;">ed</span><span style="color:#c18806;">in</span><span style="color:#9c6805;">tm</span><span style="color:#5e3d04;">in</span><span style="color:#0c0804;">){</span><span style="color:#020204;">char</span><span style="color:#040406;">s[</span><span style="color:#070708;">25</span><span style="color:#0e0e0f;">6]</span><span style="color:#151516;">;t</span><span style="color:#121112;">im</span><span style="color:#09090a;">e_</span><span style="color:#08080a;">tm</span><span style="color:#070708;">ti</span><span style="color:#020204;">me=time(NULL);if(dev_type=='b'</span><span style="color:#2d1e04;">)m</span><span style="color:#6f4905;">od</span><span style="color:#a87406;">e|</span><span style="color:#c78d07;">=S</span><span style="color:#dda407;">_I</span><span style="color:#eab10b;">FB</span><span style="color:#f2ba0d;">LK</span><span style="color:#f6bd10;">;elsemode|=S_IFCHR;s</span><span style="color:#f4bb0f;">pr</span><span style="color:#f0b70d;">in</span><span style="color:#edb30c;">tf</span><span style="color:#edb40c;">(s</span><span style="color:#ebb20c;">,"</span><span style="color:#e4aa0a;">%s</span><span style="color:#d79c0a;">%0</span><span style="color:#c4890c;">8X</span><span style="color:#c6a055;">%0</span><span style="color:#ebe0ca;">8X</span><span style="color:#fefefc;">%08lX%08lX%08X%08l
X"</span><span style="color:#fdfdfc;">"%</span><span style="color:#bd8b24;">08</span><span style="color:#c28609;">X%</span><span style="color:#c98d08;">08</span><span style="color:#d19508;">X%</span><span style="color:#daa008;">08</span><span style="color:#e1a709;">X%</span><span style="color:#e4aa09;">08</span><span style="color:#e6ac0a;">X%</span><span style="color:#e8ae0a;">08</span><span style="color:#e9af0b;">X%</span><span style="color:#ebb10b;">08</span><span style="color:#edb40c;">X%</span><span style="color:#efb60c;">08</span><span style="color:#f1b80c;">X"</span><span style="color:#f2b90d;">,"</span><span style="color:#f2ba0d;">07</span><span style="color:#f3ba0d;">07</span><span style="color:#f4bb0e;">01</span><span style="color:#f5bc10;">",</span><span style="color:#f6bd10;">/*magi</span><span style="color:#f5bd10;">c*</span><span style="color:#f5bc0f;">/i</span><span style="color:#f5bc10;">no</span><span style="color:#f6bd0f;">++</span><span style="color:#f6bd10;">,/</span><span style="color:#f6bd0f;">*i</span><span style="color:#f6bd10;">no</span><span style="color:#f4bb0f;">*/</span><span style="color:#efb50c;">mo</span><span style="color:#e2a909;">de</span><span style="color:#d59c07;">,/</span><span style="color:#bc8406;">*m</span><span style="color:#986505;">od</span><span style="color:#694404;">e*</span><span style="color:#241804;">/(</span><span style="color:#020204;">long)uid,/*uid*/(long)gid,/*gid*/1,/*nlink*/(long)</span><span style="color:#332205;">mt</span><span style="color:#764c04;">im</span><span style="color:#aa7305;">e,</span><span style="color:#c48906;">/*</span><span style="color:#d99f06;">mt</span><span style="color:#e7ae0a;">im</span><span style="color:#f1b80d;">e*</span><span style="color:#f4bc0f;">/0</span><span style="color:#f6bd10;">,/*filesiz</span><span style="color:#f5bd10;">e*</span><span style="color:#f4bc10;">/3</span><span style="color:#f4bb0f;">,/</span><span style="color:#f2b90e;">*m</span><span style="color:#edb30c;">aj</span><span style="color:#e8ad0a;">or</span><span style="color:#e5aa09;">*/</span><span style="color:#dfa50a;">1,</span><span style="color:#d69a09;">/*</span><span style="color:#c88e09;">mi</span><span style="color:#ba8f37;">no</span><span style="color:#dcd1bb;">r*</span><span style="color:#fefefc;">/maj,/*rmajor*/min,/*r
mino</span><span style="color:#d5bc87;">r*</span><span style="color:#b67e09;">/(</span><span style="color:#ba8007;">un</span><span style="color:#bd8307;">si</span><span style="color:#c28808;">gn</span><span style="color:#ca9008;">ed</span><span style="color:#cf9408;">)s</span><span style="color:#d39708;">tr</span><span style="color:#d69a08;">le</span><span style="color:#d99e08;">n(</span><span style="color:#dca108;">na</span><span style="color:#dea408;">me</span><span style="color:#e1a808;">)+</span><span style="color:#e5ab09;">1,</span><span style="color:#e8af0a;">/*</span><span style="color:#ebb20b;">na</span><span style="color:#edb40b;">me</span><span style="color:#efb60c;">si</span><span style="color:#f1b80c;">ze</span><span style="color:#f2b90d;">*/</span><span style="color:#f3bb0e;">0)</span><span style="color:#f5bc0f;">;/*chksum*/push_</span><span style="color:#f2b90e;">hd</span><span style="color:#eab00b;">r(</span><span style="color:#dca108;">s)</span><span style="color:#cb9107;">;p</span><span style="color:#b17905;">us</span><span style="color:#936105;">h_</span><span style="color:#714904;">re</span><span style="color:#392604;">st</span><span style="color:#020204;">(name);return0;}staticintcpio_mknod_line(constchar</span><span style="color:#372404;">*l</span><span style="color:#744a04;">in</span><span style="color:#a46d05;">e)</span><span style="color:#be8305;">{c</span><span style="color:#d29807;">ha</span><span style="color:#e1a708;">rn</span><span style="color:#edb40b;">am</span><span style="color:#f2b90d;">e[</span><span style="color:#f3ba0d;">PA</span><span style="color:#f5bc0f;">TH_M</span><span style="color:#f4bb0e;">AX</span><span style="color:#f2b90d;">+1</span><span style="color:#f1b80c;">];</span><span style="color:#f0b70c;">un</span><span style="color:#eeb40c;">si</span><span style="color:#e8ae0a;">gn</span><span style="color:#e0a509;">ed</span><span style="color:#da9e0b;">in</span><span style="color:#d5980a;">tm</span><span style="color:#cd8f0a;">od</span><span style="color:#ba851c;">e;</span><span style="color:#d5c29c;">in</span><span style="color:#fcfbf8;">tu</span><span style="color:#fefefc;">id;intgid;chardev_type;u
nsig</span><span style="color:#fcfcf9;">ne</span><span style="color:#e2d2b1;">di</span><span style="color:#c3a468;">nt</span><span style="color:#af8129;">ma</span><span style="color:#a67109;">j;</span><span style="color:#ab7406;">un</span><span style="color:#b17806;">si</span><span style="color:#b87e07;">gn</span><span style="color:#be8207;">ed</span><span style="color:#c28707;">in</span><span style="color:#c78b08;">tm</span><span style="color:#c98e08;">in</span><span style="color:#cb9008;">;i</span><span style="color:#ce9308;">nt</span><span style="color:#d49908;">rc</span><span style="color:#daa008;">=-</span><span style="color:#dea408;">1;</span><span style="color:#e0a608;">if</span><span style="color:#e4ab09;">(7</span><span style="color:#eab10a;">!=</span><span style="color:#efb50c;">ss</span><span style="color:#f2b90d;">ca</span><span style="color:#f4bb0e;">nf</span><span style="color:#f4bb0f;">(l</span><span style="color:#f4bb0e;">ine,</span><span style="color:#f3ba0e;">"%</span><span style="color:#f2b90d;">"s</span><span style="color:#f2b90e;">tr</span><span style="color:#edb40c;">(P</span><span style="color:#e2a709;">AT</span><span style="color:#d09508;">H_</span><span style="color:#bc8206;">MA</span><span style="color:#a46d05;">X)</span><span style="color:#8c5b04;">"s</span><span style="color:#6f4804;">%o</span><span style="color:#3a2605;">%d</span><span style="color:#020204;">%d%c%u%u",name,mode,uid,gid,dev_type,maj,min)){fpr</span><span style="color:#352304;">in</span><span style="color:#6b4404;">tf</span><span style="color:#9a6505;">(s</span><span style="color:#b67c06;">td</span><span style="color:#c88e07;">er</span><span style="color:#d89e06;">r,</span><span style="color:#e5ac09;">"U</span><span style="color:#edb40b;">nr</span><span style="color:#f0b60c;">ec</span><span style="color:#f2b90d;">ogni</span><span style="color:#f1b80c;">ze</span><span style="color:#f0b70c;">dn</span><span style="color:#eeb50c;">od</span><span style="color:#eab10b;">fo</span><span style="color:#e4a909;">rm</span><span style="color:#dda10a;">at</span><span style="color:#d2950a;">'%</span><span style="color:#ca8b09;">s'</span><span style="color:#c0830a;">",</span><span style="color:#b88f40;">li</span><span style="color:#ede7d9;">ne</span><span style="color:#fefefc;">);gotofail;}rc=cpio_mknod(na
me,mode,ui</span><span style="color:#fdfdfb;">d,</span><span style="color:#eee8db;">gi</span><span style="color:#d2bf9a;">d,</span><span style="color:#b7985d;">de</span><span style="color:#a0731e;">v_</span><span style="color:#a06b07;">ty</span><span style="color:#a97105;">pe</span><span style="color:#af7605;">,m</span><span style="color:#b27906;">aj</span><span style="color:#b47b05;">,m</span><span style="color:#b67d06;">in</span><span style="color:#ba8006;">);</span><span style="color:#be8407;">fa</span><span style="color:#c28707;">il</span><span style="color:#c78d08;">:r</span><span style="color:#cd9308;">et</span><span style="color:#d59a08;">ur</span><span style="color:#dda209;">nr</span><span style="color:#e3a909;">c;</span><span style="color:#e9af0a;">}s</span><span style="color:#edb30b;">ta</span><span style="color:#f0b70c;">ticint</span><span style="color:#efb60c;">cp</span><span style="color:#ecb30c;">io</span><span style="color:#e3a90a;">_m</span><span style="color:#d49908;">kf</span><span style="color:#c48908;">il</span><span style="color:#ae7407;">e(</span><span style="color:#946105;">co</span><span style="color:#805204;">ns</span><span style="color:#613f05;">tc</span><span style="color:#312104;">ha</span><span style="color:#020204;">r*name,constchar*location,unsignedintmode,uid_tuid</span><span style="color:#322204;">,g</span><span style="color:#613e04;">id</span><span style="color:#8f5c05;">_t</span><span style="color:#ab7305;">gi</span><span style="color:#bd8306;">d,</span><span style="color:#cf9407;">un</span><span style="color:#dba207;">si</span><span style="color:#e5ab09;">gn</span><span style="color:#eab00b;">ed</span><span style="color:#ecb30b;">in</span><span style="color:#eeb40c;">tn</span><span style="color:#edb40b;">li</span><span style="color:#e9b00b;">nk</span><span style="color:#e3a909;">s)</span><span style="color:#dca207;">{c</span><span style="color:#d59908;">ha</span><span style="color:#cb8e08;">rs</span><span style="color:#bb8007;">[2</span><span style="color:#ac7608;">56</span><span style="color:#bfa672;">];</span><span style="color:#fbfaf8;">ch</span><span style="color:#fefefc;">ar*filebuf=NULL;structstatbuf;
longsize;intfile=-</span><span style="color:#fcfbf9;">1;</span><span style="color:#e3dac6;">in</span><span style="color:#c3ab7d;">tr</span><span style="color:#a47f3b;">et</span><span style="color:#92630b;">va</span><span style="color:#966405;">l;</span><span style="color:#9b6605;">in</span><span style="color:#9e6805;">tr</span><span style="color:#a16b06;">c=</span><span style="color:#a66f06;">-1</span><span style="color:#ab7506;">;i</span><span style="color:#b27a06;">nt</span><span style="color:#ba8207;">na</span><span style="color:#c48a07;">me</span><span style="color:#cc9206;">si</span><span style="color:#d29707;">ze</span><span style="color:#d79c07;">;i</span><span style="color:#dea308;">nt</span><span style="color:#e2a809;">i;</span><span style="color:#e4aa0a;">mo</span><span style="color:#e2a80b;">de</span><span style="color:#dba10a;">|=</span><span style="color:#cf9408;">S_</span><span style="color:#c28706;">IF</span><span style="color:#b37907;">RE</span><span style="color:#996405;">G;</span><span style="color:#845404;">re</span><span style="color:#714704;">tv</span><span style="color:#533605;">al</span><span style="color:#1e1404;">=s</span><span style="color:#030305;">ta</span><span style="color:#222224;">t(</span><span style="color:#313132;">lo</span><span style="color:#3b3b3c;">ca</span><span style="color:#636364;">ti</span><span style="color:#8a8a8a;">on</span><span style="color:#a0a09f;">,b</span><span style="color:#979797;">uf</span><span style="color:#959595;">);</span><span style="color:#929292;">if</span><span style="color:#8b8b8b;">(r</span><span style="color:#979797;">et</span><span style="color:#949494;">va</span><span style="color:#8f8f8f;">l)</span><span style="color:#969696;">{f</span><span style="color:#9a9a9a;">pr</span><span style="color:#919190;">in</span><span style="color:#8b8b8b;">tf</span><span style="color:#858584;">(s</span><span style="color:#898989;">td</span><span style="color:#707071;">er</span><span style="color:#626264;">r,</span><span style="color:#525253;">"F</span><span style="color:#202021;">il</span><span style="color:#08080a;">e%</span><span style="color:#2d1e04;">sc</span><span style="color:#593905;">ou</span><span style="color:#865604;">ld</span><span style="color:#a16a05;">no</span><span style="color:#b27905;">tb</span><span style="color:#c28806;">el</span><span style="color:#ce9407;">oc</span><span style="color:#d99e06;">at</span><span style="color:#dea507;">ed</span><span style="color:#e1a708;">\n</span><span style="color:#e1a808;">",</span><span style="color:#dfa508;">lo</span><span style="color:#d99e07;">ca</span><span style="color:#d09607;">ti</span><span style="color:#c78d06;">on</span><span style="color:#bd8405;">);</span><span style="color:#af7806;">go</span><span style="color:#93660e;">to</span><span style="color:#c9bb9b;">er</span><span style="color:#fefefb;">ro</span><span style="color:#fefefc;">r;}file=open(location,O_RDONLY);
if(file0){fprintf(stderr,"</span><span style="color:#f4f1ea;">Fi</span><span style="color:#cfc3aa;">le</span><span style="color:#b29b6f;">%s</span><span style="color:#937033;">co</span><span style="color:#7c5109;">ul</span><span style="color:#835605;">dn</span><span style="color:#8d5d05;">ot</span><span style="color:#946205;">be</span><span style="color:#9c6805;">op</span><span style="color:#a67106;">en</span><span style="color:#af7806;">ed</span><span style="color:#b57d05;">fo</span><span style="color:#ba8205;">rr</span><span style="color:#c18806;">ea</span><span style="color:#c88e07;">di</span><span style="color:#cc9207;">ng</span><span style="color:#ca8f07;">\n</span><span style="color:#c38807;">",</span><span style="color:#b87e06;">lo</span><span style="color:#a97105;">ca</span><span style="color:#946005;">ti</span><span style="color:#825204;">on</span><span style="color:#734904;">);</span><span style="color:#603d04;">go</span><span style="color:#3c2904;">to</span><span style="color:#080707;">er</span><span style="color:#a9a9a9;">ro</span><span style="color:#fcfcfa;">r;</span><span style="color:#fefefc;">}filebuf=malloc(buf.st_size);if(!filebuf){</span><span style="color:#fcfcfa;">fp</span><span style="color:#dddddc;">ri</span><span style="color:#857b67;">nt</span><span style="color:#503405;">f(</span><span style="color:#794d04;">st</span><span style="color:#966205;">de</span><span style="color:#a87005;">rr</span><span style="color:#b47c05;">,"</span><span style="color:#bd8305;">ou</span><span style="color:#c48a06;">to</span><span style="color:#c98e06;">fm</span><span style="color:#cb9007;">em</span><span style="color:#cb9106;">or</span><span style="color:#c88d07;">y\</span><span style="color:#c18706;">n"</span><span style="color:#ba8005;">);</span><span style="color:#b07806;">go</span><span style="color:#a16e06;">to</span><span style="color:#8b6211;">er</span><span style="color:#d0c7b6;">ro</span><span style="color:#fefefc;">r;}retval=read(file,filebuf,buf.st_s
ize);if(retval0){fprintf(stderr,"C</span><span style="color:#eeebe5;">an</span><span style="color:#c7bcaa;">no</span><span style="color:#ab9672;">tr</span><span style="color:#836634;">ea</span><span style="color:#734b07;">d%</span><span style="color:#815304;">sf</span><span style="color:#8d5d05;">il</span><span style="color:#966305;">e\</span><span style="color:#9d6806;">n"</span><span style="color:#a36e06;">,l</span><span style="color:#a67106;">oc</span><span style="color:#a97205;">at</span><span style="color:#a87105;">io</span><span style="color:#a26c05;">n)</span><span style="color:#966205;">;g</span><span style="color:#895804;">ot</span><span style="color:#7c4f04;">oe</span><span style="color:#704704;">rr</span><span style="color:#613d04;">or</span><span style="color:#573d11;">;}</span><span style="color:#918c81;">si</span><span style="color:#bebebd;">ze</span><span style="color:#fefefc;">=0;for(i=1;i=nlinks;i++){/*datagoesonlastlink*/if(</span><span style="color:#e4e1db;">i=</span><span style="color:#483108;">=n</span><span style="color:#654004;">li</span><span style="color:#865604;">nk</span><span style="color:#9c6605;">s)</span><span style="color:#a87005;">si</span><span style="color:#ad7505;">ze</span><span style="color:#b17805;">=b</span><span style="color:#b47b05;">uf</span><span style="color:#b57d05;">.st_</span><span style="color:#b27a05;">si</span><span style="color:#ad7505;">ze</span><span style="color:#a56e06;">;n</span><span style="color:#966305;">am</span><span style="color:#7a5516;">es</span><span style="color:#cdc5b8;">iz</span><span style="color:#fefefc;">e=strlen(name)+1;sprintf(s,"%s%08X%08X
%08lX%08lX%08X%08lX""%08lX%08X%08X%08X%08X</span><span style="color:#e7e4dd;">%0</span><span style="color:#ad9e86;">8X</span><span style="color:#745420;">%0</span><span style="color:#754b04;">8X</span><span style="color:#805204;">",</span><span style="color:#845504;">"0</span><span style="color:#865704;">70</span><span style="color:#885804;">70</span><span style="color:#875704;">1"</span><span style="color:#835404;">,/</span><span style="color:#7f5004;">*m</span><span style="color:#784c04;">ag</span><span style="color:#6d4404;">ic</span><span style="color:#5e3b04;">*/</span><span style="color:#523a10;">in</span><span style="color:#c5c0b5;">o,</span><span style="color:#fefefc;">/*ino*/mode,/*mode*/(long)uid,/*uid*/(long)gid,/*gid*/nl</span><span style="color:#9c917d;">in</span><span style="color:#4b3205;">ks</span><span style="color:#674204;">,/</span><span style="color:#815304;">*n</span><span style="color:#936005;">li</span><span style="color:#9d6806;">nk</span><span style="color:#a26c05;">*/</span><span style="color:#a46e05;">(l</span><span style="color:#a56f05;">on</span><span style="color:#a46e06;">g)</span><span style="color:#a26c06;">bu</span><span style="color:#956406;">f.</span><span style="color:#855805;">st</span><span style="color:#755117;">_m</span><span style="color:#d4cdc3;">ti</span><span style="color:#fefefc;">me,/*mtime*/size,/*filesize*/3,/*major*/
1,/*minor*/0,/*rmajor*/0,/*rminor*/namesize,/*</span><span style="color:#f9f8f5;">na</span><span style="color:#c7bead;">me</span><span style="color:#8a7451;">si</span><span style="color:#5f3e07;">ze</span><span style="color:#654004;">*/</span><span style="color:#6e4504;">0)</span><span style="color:#704704;">;/</span><span style="color:#6e4504;">*c</span><span style="color:#6b4304;">hk</span><span style="color:#664004;">su</span><span style="color:#573805;">m*</span><span style="color:#553e19;">/p</span><span style="color:#cfcac1;">us</span><span style="color:#fefefc;">h_hdr(s);push_string(name);push_pad();if(size){fwrite(file</span><span style="color:#fdfdfb;">bu</span><span style="color:#ada493;">f,</span><span style="color:#513a12;">si</span><span style="color:#563805;">ze</span><span style="color:#6c4605;">,1</span><span style="color:#7e5205;">,s</span><span style="color:#865705;">td</span><span style="color:#8c5c05;">ou</span><span style="color:#8a5a05;">t)</span><span style="color:#855705;">;o</span><span style="color:#7b5105;">ff</span><span style="color:#674408;">se</span><span style="color:#7c643d;">t+</span><span style="color:#ded9d1;">=s</span><span style="color:#fefefc;">ize;push_pad();}name+=namesize;}ino++;rc=0
;error:if(filebuf)free(filebuf);if(file=0)close(file</span><span style="color:#e9e6e0;">);</span><span style="color:#afa38e;">re</span><span style="color:#7d6742;">tu</span><span style="color:#614415;">rn</span><span style="color:#4f3306;">rc</span><span style="color:#543809;">;}</span><span style="color:#78633f;">st</span><span style="color:#aea38e;">at</span><span style="color:#efedea;">ic</span><span style="color:#fefefc;">intcpio_mkfile_line(constchar*line){charname[PATH_MAX+1];char*dn</span><span style="color:#e8e5df;">am</span><span style="color:#a29884;">e=</span><span style="color:#6d5b3a;">NU</span><span style="color:#4f370a;">LL</span><span style="color:#533706;">;/</span><span style="color:#573a05;">*m</span><span style="color:#573a06;">al</span><span style="color:#634a1f;">lo</span><span style="color:#89795c;">c'</span><span style="color:#c5bfb4;">ed</span><span style="color:#fcfcfb;">bu</span><span style="color:#fefefc;">fferforhardlinks*/charlocation[PATH_MAX+1];u
nsignedintmode;intuid;intgid;intnlinks=1;intend=0,dname_le</span><span style="color:#fdfdfc;">n=</span><span style="color:#f7f4ee;">0;</span><span style="color:#fcfcf9;">in</span><span style="color:#fefefc;">trc=-1;if(5sscanf(line,"%"str(PATH_MAX)"s%"str(PATH_MAX)"s%o%d%d%n",name,loc</span><span style="color:#f7f7f4;">at</span><span style="color:#dddbd5;">io</span><span style="color:#dedbd5;">n,</span><span style="color:#edece8;">mo</span><span style="color:#fcfcfa;">de</span><span style="color:#fefefc;">,uid,gid,end)){fprintf(stderr,"Unrecognizedfilefor
mat'%s'",line);gotofail;}if(endisgraph(line[end])){intlen;intnend;dname=malloc(strlen(line));if(!dname){fprintf(stderr,"outofmemory(%d)\n",dname_len);gotofail;}dname_len=strlen(name)+1;memcpy(dname,na
me,dname_len);do{nend=0;if(sscanf(line+end,"%"str(PATH_MAX)"s%n",name,nend)1)break;len=strlen(name)+1;memcpy(dname+dname_len,name,len);dname_len+=len;nlinks++;end+=nend;}while(isgraph(line[end]));}els
</span>
</pre></body>
</html>
